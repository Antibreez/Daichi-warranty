!function(){var e=document.querySelector("input[name='name']"),t=document.querySelector("input[name='password']"),n=document.querySelector(".authorization__button");if(e&&t&&n){var s=function(e){var t=e.target;t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input")};n.addEventListener("click",(function(){""===e.value&&e.classList.add("js--wrong-input"),""===t.value&&t.classList.add("js--wrong-input")})),e.addEventListener("input",s),t.addEventListener("input",s)}}(),function(){var e=document.querySelector(".not-used-products__button"),t=document.querySelector(".not-used-products__show"),n=document.querySelector(".not-used-products__hide"),s=document.querySelector(".not-used-products__content"),a=document.querySelector(".account-header__dropdown"),o=document.querySelector(".account-header__nav"),c=document.querySelector(".account-header__nav-button");if(e){var r=function(e){e.classList.toggle("js--shown"),e.classList.toggle("js--hidden")};e.addEventListener("click",(function(){r(t),r(n),s.classList.toggle("js--show")})),a.addEventListener("click",(function(){o.classList.contains("js--show")||o.classList.add("js--show")})),c.addEventListener("click",(function(){o.classList.contains("js--show")&&o.classList.remove("js--show")}))}}(),function(){var e=document.querySelector(".product-registration"),t=document.querySelectorAll(".product-registration__navigation-item"),n=(document.querySelector(".contacts"),document.querySelector(".contacts__phone-number")),s=document.querySelector(".contacts__code"),a=document.querySelector("input[name='phone-number']"),o=document.querySelector("input[name='phone-code']"),c=document.querySelector(".contacts__phone-form button"),r=document.querySelector(".contacts__code-form button"),i=document.querySelector(".contacts__phone-form"),d=document.querySelector(".contacts__code-form"),u=document.querySelector(".contacts__product-card .product-card__change"),l=document.querySelector(".contacts__selected-phone"),m=document.querySelector(".contacts__code-error-message"),p=document.querySelector(".contacts__code-form label"),v=document.querySelector(".contacts__selected-phone-change"),L="Указан неверный код, осталось попыток: 1",y="Вы превысили количество попыток, следующий запрос кода возможен через 10 минут",_=0;if(a){new Inputmask("+7(999)999-99-99").mask(a),new Inputmask("9999999",{placeholder:""}).mask(o);var f=function(e){e.classList.contains("hidden")&&e.classList.remove("hidden")},g=function(e){e.classList.contains("hidden")||e.classList.add("hidden")};a.addEventListener("input",(function(){var e=a.value;16===e.length&&-1===e.indexOf("_")?c.removeAttribute("disabled"):c.setAttribute("disabled","")})),u.addEventListener("click",(function(){e.classList.remove("js--contacts"),e.classList.add("js--product-data"),t[0].classList.remove("js--checked"),t[1].classList.remove("js--active"),f(n),g(s)})),i.addEventListener("submit",(function(e){e.preventDefault(),l.textContent=a.value,g(n),f(s),o.focus()})),o.addEventListener("input",(function(){m.textContent="",p.classList.contains("js--error")&&p.classList.remove("js--error"),o.classList.contains("js--wrong-input")&&o.classList.remove("js--wrong-input"),7===o.value.length?r.removeAttribute("disabled"):r.setAttribute("disabled","")})),d.addEventListener("submit",(function(n){n.preventDefault(),"0000000"!==o.value?(p.classList.contains("js--error")||p.classList.add("js--error"),o.classList.contains("js--wrong-input")||o.classList.add("js--wrong-input"),0===_&&(m.textContent=L),_>0&&(m.textContent=y,r.setAttribute("disabled","")),_++):e.classList.contains("product-registration--account")?(e.classList.add("js--registration-end"),e.classList.remove("js--contacts"),t[0].classList.add("js--checked"),t[1].classList.add("js--active")):(e.classList.add("js--personal-data"),e.classList.remove("js--contacts"))})),v.addEventListener("click",(function(){g(s),f(n),a.focus()}))}}(),function(){var e=document.querySelector("body"),t=document.querySelector("input[name='phone-number']"),n=document.querySelector(".product-registration"),s=document.querySelectorAll(".product-registration__navigation-item"),a=(document.querySelector(".product-data"),document.querySelector(".product-data form")),o=document.querySelector("label[for='serial-number-1'] button"),c=document.querySelector(".popup-warranty"),r=document.querySelector(".popup-warranty__close"),i=document.querySelector(".popup-warranty__overlay"),d=document.querySelector(".product-data__purchase-date"),u=document.querySelector(".product-data__calendar"),l=document.querySelectorAll(".product-data__serial-number"),m=document.querySelector(".product-data__submit");if(o){var p=function(){l[0].checkValidity()&&l[1].checkValidity()&&l[2].checkValidity()&&/^[0-9.]+$/.test(d.value)?m.removeAttribute("disabled"):m.setAttribute("disabled","")},v=function(e){return Math.floor(e/10)>0?e:"0"+e},L=new Pikaday({field:u,firstDay:1,onSelect:function(){var e=new Date(L);d.value=function(e){var t=(e=new Date(e)).getDate(),n=e.getMonth()+1,s=e.getFullYear();return v(t)+"."+v(n)+"."+s}(e),p()}});new Inputmask("99.99.9999",{placeholder:"ДД.ММ.ГГГГ"}).mask(d);var y=function(e){var t=e.target;t.setCustomValidity(""),/^[A-Za-z0-9]{6}/.test(t.value)||6!==t.value.length||(t.setCustomValidity("Разрешены только латинские буквы и цыфры"),t.reportValidity()),/^[A-Za-z0-9]{6}/.test(t.value)&&6===t.value.length?(t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"),"serial-number-1"!==t.id&&"serial-number-2"!==t.id||t.nextSibling.nextSibling.focus(),"serial-number-3"===t.id&&d.focus()):t.classList.add("js--wrong-input"),p()},_=function(){c.classList.add("hidden"),e.classList.remove("popup")};o.addEventListener("click",(function(){c.classList.remove("hidden"),e.classList.add("popup")})),r.addEventListener("click",(function(){_()})),i.addEventListener("click",(function(){_()})),l.forEach((function(e){e.addEventListener("input",y)})),d.addEventListener("input",(function(){p(),console.log(d.value.length)})),a.addEventListener("submit",(function(e){e.preventDefault(),n.classList.add("js--contacts"),n.classList.remove("js--product-data"),n.classList.contains("product-registration--account")||(s[0].classList.add("js--checked"),s[1].classList.add("js--active")),t.focus()}))}}(),function(){var e=document.querySelector(".product-registration"),t=document.querySelectorAll(".product-registration__navigation-item"),n=document.querySelector(".personal-data__form"),s=document.querySelector(".personal-data input[name='surname']"),a=document.querySelector(".personal-data input[name='name']"),o=document.querySelector(".personal-data input[name='patronymic']"),c=document.querySelector(".personal-data input[name='city']"),r=document.querySelector(".personal-data input[name='email']"),i=document.querySelector(".personal-data input[type='checkbox']"),d=document.querySelector(".personal-data__agreement-wrapper label"),u=document.querySelector(".personal-data__text-wrapper"),l=document.querySelector(".personal-data__button");if(s){var m=function(){s.validity.valid&&a.validity.valid&&o.validity.valid&&c.validity.valid&&r.validity.valid&&i.checked?l.removeAttribute("disabled"):l.setAttribute("disabled","")},p=function(e){m();var t=e.target,n=t.parentNode.querySelector("p");t.validity.valid||(n.classList.contains("js--error")||n.classList.add("js--error"),t.classList.contains("js--wrong-input")||t.classList.add("js--wrong-input")),t.validity.valid&&(n.classList.contains("js--error")&&n.classList.remove("js--error"),t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"))};s.addEventListener("input",p),a.addEventListener("input",p),o.addEventListener("input",p),c.addEventListener("input",p),r.addEventListener("input",p),i.addEventListener("change",(function(){m(),i.checked||(d.classList.contains("js--wrong-input")||d.classList.add("js--wrong-input"),u.classList.contains("js--error")||u.classList.add("js--error")),i.checked&&(d.classList.contains("js--wrong-input")&&d.classList.remove("js--wrong-input"),u.classList.contains("js--error")&&u.classList.remove("js--error"))})),n.addEventListener("submit",(function(n){n.preventDefault(),e.classList.remove("js--personal-data"),e.classList.add("js--registration-end"),t[1].classList.add("js--checked"),t[2].classList.add("js--active")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiLCJhY2NvdW50LmpzIiwiY29udGFjdHMuanMiLCJwcm9kdWN0LWRhdGEuanMiLCJwZXJzb25hbC1kYXRhLmpzIl0sIm5hbWVzIjpbIm5hbWVJbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInBhc3N3b3JkSW5wdXQiLCJzdWJtaXRCdXR0b24iLCJvbklucHV0IiwiZXZ0IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwidmFsdWUiLCJhZGQiLCJvbGRQcm9kdWN0c0J1dHRvbiIsIm9sZFByb2R1Y3RzU2hvdyIsIm9sZFByb2R1Y3RzSGlkZSIsIm9sZFByb2R1Y3RzIiwiZHJvcGRvd24iLCJuYXZpZ2F0aW9uIiwiY2xvc2VOYXZCdXR0b24iLCJvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZSIsIml0ZW0iLCJ0b2dnbGUiLCJwcm9kdWN0UmVnaXN0cmF0aW9uIiwicmVnaXN0cmF0aW9uSXRlbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb250YWN0c1Bob25lIiwiY29udGFjdHNDb2RlIiwicGhvbmVJbnB1dCIsImNvZGVJbnB1dCIsInBob25lQnV0dG9uIiwiY29kZUJ1dHRvbiIsInBob25lRm9ybSIsImNvZGVGb3JtIiwicHJvZHVjdENoYW5nZUJ1dHRvbiIsInNlbGVjdGVkUGhvbmUiLCJjb2RlRXJyb3IiLCJjb2RlTGFiZWwiLCJwaG9uZUNoYW5nZUJ1dHRvbiIsIkVSUk9SX01FU1NBR0VTIiwiYXR0ZW1wdHMiLCJJbnB1dG1hc2siLCJtYXNrIiwicGxhY2Vob2xkZXIiLCJzaG93IiwiaGlkZSIsInN0ciIsImxlbmd0aCIsImluZGV4T2YiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJwcmV2ZW50RGVmYXVsdCIsInRleHRDb250ZW50IiwiZm9jdXMiLCJib2R5IiwicHJvZHVjdERhdGFGb3JtIiwid2FycmFudHlDb2RlQnV0dG9uIiwicG9wdXAiLCJwb3B1cENsb3NlIiwicG9wdXBPdmVybGF5IiwiY2FsZW5kYXJJbnB1dCIsImNhbGVuZGFyQnV0dG9uIiwic2VyaWFsTnVtYmVySW5wdXQiLCJkYXRhU3VibWl0IiwiY2hlY2tWYWxpZGl0eSIsInRlc3QiLCJnZXRDb3JyZWN0TnVtYmVyIiwibnVtIiwiTWF0aCIsImZsb29yIiwicGlja2VyIiwiUGlrYWRheSIsImZpZWxkIiwiZmlyc3REYXkiLCJvblNlbGVjdCIsImRhdGUiLCJEYXRlIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJvblNlcmlhbE51bWJlcklucHV0Iiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJyZXBvcnRWYWxpZGl0eSIsImlkIiwibmV4dFNpYmxpbmciLCJjbG9zZVBvcHVwIiwiZm9yRWFjaCIsImVsIiwiY29uc29sZSIsImxvZyIsImZvcm0iLCJzdXJuYW1lSW5wdXQiLCJwYXRyb255bWljSW5wdXQiLCJjaXR5SW5wdXQiLCJlbWFpbElucHV0IiwiY2hlY2tib3giLCJjaGVja2JveExhYmVsIiwiYWdyZWVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImNoZWNrZWQiLCJsYWJlbCIsInBhcmVudE5vZGUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxzQkFDQUMsRUFBQUYsU0FBQUMsY0FBQSwwQkFDQUUsRUFBQUgsU0FBQUMsY0FBQSwwQkFFQSxHQUFBRixHQUFBRyxHQUFBQyxFQUFBLENBSUEsSUFVQUMsRUFBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFDLE9BQ0FBLEVBQUFDLFVBQUFDLFNBQUEsb0JBQ0FGLEVBQUFDLFVBQUFFLE9BQUEsb0JBSUFOLEVBQUFPLGlCQUFBLFNBakJBLFdBQ0EsS0FBQVgsRUFBQVksT0FDQVosRUFBQVEsVUFBQUssSUFBQSxtQkFHQSxLQUFBVixFQUFBUyxPQUNBVCxFQUFBSyxVQUFBSyxJQUFBLHNCQVlBYixFQUFBVyxpQkFBQSxRQUFB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aUJBRUE1QixFQUFBaEIsVUFBQUUsT0FBQSxxQkFDQWMsRUFBQWhCLFVBQUFLLElBQUEsd0JBRUFZLEVBQUEsR0FBQWpCLFVBQUFLLElBQUEsZUFDQVksRUFBQSxHQUFBakIsVUFBQUssSUFBQSxrQkE1RkEiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gIHZhciBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0nbmFtZSddXCIpO1xuICB2YXIgcGFzc3dvcmRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xuICB2YXIgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF1dGhvcml6YXRpb25fX2J1dHRvbicpO1xuXG4gIGlmICghbmFtZUlucHV0IHx8ICFwYXNzd29yZElucHV0IHx8ICFzdWJtaXRCdXR0b24pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgb25TdWJtaXRCdXR0b25DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobmFtZUlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgbmFtZUlucHV0LmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgIH1cblxuICAgIGlmIChwYXNzd29yZElucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgcGFzc3dvcmRJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG4gIH1cblxuICB2YXIgb25JbnB1dCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcbiAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgIHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG4gIH1cblxuICBzdWJtaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblN1Ym1pdEJ1dHRvbkNsaWNrKTtcbiAgbmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIHBhc3N3b3JkSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICB2YXIgb2xkUHJvZHVjdHNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90LXVzZWQtcHJvZHVjdHNfX2J1dHRvbicpO1xuICB2YXIgb2xkUHJvZHVjdHNTaG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19zaG93Jyk7XG4gIHZhciBvbGRQcm9kdWN0c0hpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90LXVzZWQtcHJvZHVjdHNfX2hpZGUnKTtcbiAgdmFyIG9sZFByb2R1Y3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19jb250ZW50Jyk7XG4gIHZhciBkcm9wZG93biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY2NvdW50LWhlYWRlcl9fZHJvcGRvd24nKTtcbiAgdmFyIG5hdmlnYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWNjb3VudC1oZWFkZXJfX25hdicpO1xuICB2YXIgY2xvc2VOYXZCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWNjb3VudC1oZWFkZXJfX25hdi1idXR0b24nKTtcblxuICBpZiAoIW9sZFByb2R1Y3RzQnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG9sZFByb2R1Y3RzQnV0dG9uVG9nZ2xlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2pzLS1zaG93bicpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnanMtLWhpZGRlbicpO1xuICB9O1xuXG4gIHZhciBvbk9sZFByb2R1Y3RzQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUob2xkUHJvZHVjdHNTaG93KTtcbiAgICBvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZShvbGRQcm9kdWN0c0hpZGUpO1xuICAgIG9sZFByb2R1Y3RzLmNsYXNzTGlzdC50b2dnbGUoJ2pzLS1zaG93Jyk7XG4gIH07XG5cbiAgdmFyIG9uRHJvcGRvd25DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIW5hdmlnYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tc2hvdycpKSB7XG4gICAgICBuYXZpZ2F0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1zaG93Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uTmF2Q2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobmF2aWdhdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1zaG93JykpIHtcbiAgICAgIG5hdmlnYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXNob3cnKTtcbiAgICB9XG4gIH1cblxuICBvbGRQcm9kdWN0c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT2xkUHJvZHVjdHNCdXR0b25DbGljayk7XG4gIGRyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Ecm9wZG93bkNsaWNrKTtcbiAgY2xvc2VOYXZCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk5hdkNsb3NlQ2xpY2spO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIHZhciBwcm9kdWN0UmVnaXN0cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgY29udGFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHMnKTtcbiAgdmFyIGNvbnRhY3RzUGhvbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3Bob25lLW51bWJlcicpO1xuICB2YXIgY29udGFjdHNDb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlJyk7XG4gIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLW51bWJlciddXCIpO1xuICB2YXIgY29kZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLWNvZGUnXVwiKVxuICB2YXIgcGhvbmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3Bob25lLWZvcm0gYnV0dG9uJyk7XG4gIHZhciBjb2RlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlLWZvcm0gYnV0dG9uJylcbiAgdmFyIHBob25lRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtZm9ybScpO1xuICB2YXIgY29kZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybScpO1xuICB2YXIgcHJvZHVjdENoYW5nZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcHJvZHVjdC1jYXJkIC5wcm9kdWN0LWNhcmRfX2NoYW5nZScpO1xuICB2YXIgc2VsZWN0ZWRQaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fc2VsZWN0ZWQtcGhvbmUnKTtcbiAgdmFyIGNvZGVFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1lcnJvci1tZXNzYWdlJyk7XG4gIHZhciBjb2RlTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybSBsYWJlbCcpO1xuICB2YXIgcGhvbmVDaGFuZ2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3NlbGVjdGVkLXBob25lLWNoYW5nZScpO1xuXG4gIHZhciBDT1JSRUNUX0NPREUgPSAnMDAwMDAwMCc7XG4gIHZhciBFUlJPUl9NRVNTQUdFUyA9IHtcbiAgICBmaXJzdDogJ9Cj0LrQsNC30LDQvSDQvdC10LLQtdGA0L3Ri9C5INC60L7QtCwg0L7RgdGC0LDQu9C+0YHRjCDQv9C+0L/Ri9GC0L7QujogMScsXG4gICAgc2Vjb25kOiAn0JLRiyDQv9GA0LXQstGL0YHQuNC70Lgg0LrQvtC70LjRh9C10YHRgtCy0L4g0L/QvtC/0YvRgtC+0LosINGB0LvQtdC00YPRjtGJ0LjQuSDQt9Cw0L/RgNC+0YEg0LrQvtC00LAg0LLQvtC30LzQvtC20LXQvSDRh9C10YDQtdC3IDEwINC80LjQvdGD0YInXG4gIH07XG5cbiAgdmFyIGF0dGVtcHRzID0gMDtcblxuICBpZiAoIXBob25lSW5wdXQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW1QaG9uZSA9IG5ldyBJbnB1dG1hc2soJys3KDk5OSk5OTktOTktOTknKTtcbiAgaW1QaG9uZS5tYXNrKHBob25lSW5wdXQpO1xuXG4gIHZhciBpbUNvZGUgPSBuZXcgSW5wdXRtYXNrKCc5OTk5OTk5JywgeyBwbGFjZWhvbGRlcjogJycgfSk7XG4gIGltQ29kZS5tYXNrKGNvZGVJbnB1dCk7XG5cbiAgdmFyIHNob3cgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBoaWRlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNsZWFyRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29kZUVycm9yLnRleHRDb250ZW50ID0gJyc7XG5cbiAgICBpZiAoY29kZUxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgIGNvZGVMYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAoY29kZUlucHV0LmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgIGNvZGVJbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uUGhvbmVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc3RyID0gcGhvbmVJbnB1dC52YWx1ZTtcbiAgICBpZiAoc3RyLmxlbmd0aCA9PT0gMTYgJiYgc3RyLmluZGV4T2YoJ18nKSA9PT0gLTEpIHtcbiAgICAgIHBob25lQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGhvbmVCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uUHJvZHVjdENoYW5nZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLWNvbnRhY3RzJyk7XG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QuYWRkKCdqcy0tcHJvZHVjdC1kYXRhJyk7XG5cbiAgICByZWdpc3RyYXRpb25JdGVtWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1jaGVja2VkJyk7XG4gICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tYWN0aXZlJyk7XG5cbiAgICBzaG93KGNvbnRhY3RzUGhvbmUpO1xuICAgIGhpZGUoY29udGFjdHNDb2RlKTtcbiAgfTtcblxuICB2YXIgb25QaG9uZVN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBzZWxlY3RlZFBob25lLnRleHRDb250ZW50ID0gcGhvbmVJbnB1dC52YWx1ZTtcbiAgICBoaWRlKGNvbnRhY3RzUGhvbmUpO1xuICAgIHNob3coY29udGFjdHNDb2RlKTtcblxuICAgIGNvZGVJbnB1dC5mb2N1cygpO1xuICB9O1xuXG4gIHZhciBvblBob25lQ2hhbmdlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgaGlkZShjb250YWN0c0NvZGUpO1xuICAgIHNob3coY29udGFjdHNQaG9uZSk7XG5cbiAgICBwaG9uZUlucHV0LmZvY3VzKCk7XG4gIH1cblxuICB2YXIgb25Db2RlSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2xlYXJFcnJvcigpO1xuICAgIGlmIChjb2RlSW5wdXQudmFsdWUubGVuZ3RoID09PSA3KSB7XG4gICAgICBjb2RlQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29kZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBvbkNvZGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKGNvZGVJbnB1dC52YWx1ZSAhPT0gQ09SUkVDVF9DT0RFKSB7XG4gICAgICBpZiAoIWNvZGVMYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGNvZGVMYWJlbC5jbGFzc0xpc3QuYWRkKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFjb2RlSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjb2RlSW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhdHRlbXB0cyA9PT0gMCkge1xuICAgICAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFUy5maXJzdDtcbiAgICAgIH1cblxuICAgICAgaWYgKGF0dGVtcHRzID4gMCkge1xuICAgICAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFUy5zZWNvbmQ7XG4gICAgICAgIGNvZGVCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICAgIH1cblxuICAgICAgYXR0ZW1wdHMrKztcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdwcm9kdWN0LXJlZ2lzdHJhdGlvbi0tYWNjb3VudCcpKSB7XG4gICAgICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXJlZ2lzdHJhdGlvbi1lbmQnKTtcbiAgICAgICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcblxuICAgICAgICByZWdpc3RyYXRpb25JdGVtWzBdLmNsYXNzTGlzdC5hZGQoJ2pzLS1jaGVja2VkJyk7XG4gICAgICAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5hZGQoJ2pzLS1hY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXBlcnNvbmFsLWRhdGEnKTtcbiAgICAgICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcGhvbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uUGhvbmVJbnB1dCk7XG4gIHByb2R1Y3RDaGFuZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblByb2R1Y3RDaGFuZ2VDbGljayk7XG4gIHBob25lRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvblBob25lU3VibWl0KTtcbiAgY29kZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25Db2RlSW5wdXQpO1xuICBjb2RlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbkNvZGVTdWJtaXQpO1xuICBwaG9uZUNoYW5nZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUGhvbmVDaGFuZ2VDbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLW51bWJlciddXCIpO1xuXG4gIHZhciBwcm9kdWN0UmVnaXN0cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgcHJvZHVjdERhdGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhJyk7XG4gIHZhciBwcm9kdWN0RGF0YUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhIGZvcm0nKTtcbiAgdmFyIHdhcnJhbnR5Q29kZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFtmb3I9J3NlcmlhbC1udW1iZXItMSddIGJ1dHRvblwiKTtcbiAgdmFyIHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5Jyk7XG4gIHZhciBwb3B1cENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5X19jbG9zZScpO1xuICB2YXIgcG9wdXBPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5X19vdmVybGF5Jyk7XG5cbiAgdmFyIGNhbGVuZGFySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhX19wdXJjaGFzZS1kYXRlJyk7XG4gIHZhciBjYWxlbmRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGFfX2NhbGVuZGFyJyk7XG5cbiAgdmFyIHNlcmlhbE51bWJlcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtZGF0YV9fc2VyaWFsLW51bWJlcicpO1xuICB2YXIgZGF0YVN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGFfX3N1Ym1pdCcpO1xuXG4gIGlmKCF3YXJyYW50eUNvZGVCdXR0b24pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hlY2tWYWxpZGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZihcbiAgICAgIHNlcmlhbE51bWJlcklucHV0WzBdLmNoZWNrVmFsaWRpdHkoKVxuICAgICAgJiYgc2VyaWFsTnVtYmVySW5wdXRbMV0uY2hlY2tWYWxpZGl0eSgpXG4gICAgICAmJiBzZXJpYWxOdW1iZXJJbnB1dFsyXS5jaGVja1ZhbGlkaXR5KClcbiAgICAgICYmICgvXlswLTkuXSskLykudGVzdChjYWxlbmRhcklucHV0LnZhbHVlKVxuICAgICkge1xuICAgICAgZGF0YVN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRhdGFTdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGdldENvcnJlY3ROdW1iZXIgPSBmdW5jdGlvbiAobnVtKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IobnVtIC8gMTApID4gMCA/IG51bSA6ICcwJyArIG51bTtcbiAgfTtcblxuICB2YXIgZ2V0RGF0ZSA9IGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlKTtcblxuICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcbiAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuXG4gICAgcmV0dXJuIGdldENvcnJlY3ROdW1iZXIoZGF5KSArICcuJyArIGdldENvcnJlY3ROdW1iZXIobW9udGgpICsgJy4nICsgeWVhcjtcbiAgfTtcblxuICB2YXIgcGlja2VyID0gbmV3IFBpa2FkYXkoe1xuICAgIGZpZWxkOiBjYWxlbmRhckJ1dHRvbixcbiAgICBmaXJzdERheTogMSxcbiAgICBvblNlbGVjdDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHBpY2tlcik7XG4gICAgICBjYWxlbmRhcklucHV0LnZhbHVlID0gZ2V0RGF0ZShkYXRlKTtcbiAgICAgIGNoZWNrVmFsaWRpdHkoKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBpbSA9IG5ldyBJbnB1dG1hc2soJzk5Ljk5Ljk5OTknLCB7ICdwbGFjZWhvbGRlcic6ICfQlNCULtCc0Jwu0JPQk9CT0JMnfSk7XG4gIGltLm1hc2soY2FsZW5kYXJJbnB1dCk7XG5cbiAgdmFyIG9uU2VyaWFsTnVtYmVySW5wdXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdmFyIHRhcmdldCA9IGV2dC50YXJnZXQ7XG5cbiAgICB0YXJnZXQuc2V0Q3VzdG9tVmFsaWRpdHkoJycpO1xuXG4gICAgaWYoISgvXltBLVphLXowLTldezZ9LykudGVzdCh0YXJnZXQudmFsdWUpICYmIHRhcmdldC52YWx1ZS5sZW5ndGggPT09IDYpIHtcbiAgICAgIHRhcmdldC5zZXRDdXN0b21WYWxpZGl0eSgn0KDQsNC30YDQtdGI0LXQvdGLINGC0L7Qu9GM0LrQviDQu9Cw0YLQuNC90YHQutC40LUg0LHRg9C60LLRiyDQuCDRhtGL0YTRgNGLJyk7XG4gICAgICB0YXJnZXQucmVwb3J0VmFsaWRpdHkoKTtcbiAgICB9XG5cbiAgICBpZiAoKC9eW0EtWmEtejAtOV17Nn0vKS50ZXN0KHRhcmdldC52YWx1ZSkgJiYgdGFyZ2V0LnZhbHVlLmxlbmd0aCA9PT0gNikge1xuICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRhcmdldC5pZCA9PT0gJ3NlcmlhbC1udW1iZXItMScgfHwgdGFyZ2V0LmlkID09PSAnc2VyaWFsLW51bWJlci0yJykge1xuICAgICAgICB0YXJnZXQubmV4dFNpYmxpbmcubmV4dFNpYmxpbmcuZm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRhcmdldC5pZCA9PT0gJ3NlcmlhbC1udW1iZXItMycpIHtcbiAgICAgICAgY2FsZW5kYXJJbnB1dC5mb2N1cygpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuXG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuICB9O1xuXG4gIHZhciBvbkNhbGVuZGFySW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuICAgIGNvbnNvbGUubG9nKGNhbGVuZGFySW5wdXQudmFsdWUubGVuZ3RoKTtcblxuICB9O1xuXG4gIHZhciBvcGVuUG9wdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdwb3B1cCcpO1xuICB9O1xuXG4gIHZhciBjbG9zZVBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXAnKTtcbiAgfVxuXG4gIHZhciBvbldhcnJhbnR5Q29kZUJ1dHRvbkNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIG9wZW5Qb3B1cCgpO1xuICB9O1xuXG4gIHZhciBvblBvcHVwQ2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbG9zZVBvcHVwKCk7XG4gIH07XG5cbiAgdmFyIG9uUG9wdXBPdmVybGF5Q2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2xvc2VQb3B1cCgpO1xuICB9O1xuXG4gIHZhciBvblN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1jb250YWN0cycpO1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXByb2R1Y3QtZGF0YScpO1xuXG4gICAgaWYgKCFwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5jb250YWlucygncHJvZHVjdC1yZWdpc3RyYXRpb24tLWFjY291bnQnKSkge1xuICAgICAgcmVnaXN0cmF0aW9uSXRlbVswXS5jbGFzc0xpc3QuYWRkKCdqcy0tY2hlY2tlZCcpO1xuICAgICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QuYWRkKCdqcy0tYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgcGhvbmVJbnB1dC5mb2N1cygpO1xuICB9O1xuXG4gIHdhcnJhbnR5Q29kZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uV2FycmFudHlDb2RlQnV0dG9uQ2xpY2spO1xuICBwb3B1cENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Qb3B1cENsb3NlQ2xpY2spO1xuICBwb3B1cE92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblBvcHVwT3ZlcmxheUNsaWNrKTtcblxuICBzZXJpYWxOdW1iZXJJbnB1dC5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25TZXJpYWxOdW1iZXJJbnB1dCk7XG4gIH0pO1xuXG4gIGNhbGVuZGFySW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkNhbGVuZGFySW5wdXQpO1xuICBwcm9kdWN0RGF0YUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgb25TdWJtaXQpO1xufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIHZhciBwcm9kdWN0UmVnaXN0cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZXJzb25hbC1kYXRhX19mb3JtJyk7XG4gIHZhciBzdXJuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nc3VybmFtZSddXCIpO1xuICB2YXIgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J25hbWUnXVwiKTtcbiAgdmFyIHBhdHJvbnltaWNJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdwYXRyb255bWljJ11cIik7XG4gIHZhciBjaXR5SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nY2l0eSddXCIpO1xuICB2YXIgZW1haWxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdlbWFpbCddXCIpO1xuICB2YXIgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiKTtcbiAgdmFyIGNoZWNrYm94TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyc29uYWwtZGF0YV9fYWdyZWVtZW50LXdyYXBwZXIgbGFiZWwnKTtcbiAgdmFyIGFncmVlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YV9fdGV4dC13cmFwcGVyXCIpO1xuICB2YXIgc3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlcnNvbmFsLWRhdGFfX2J1dHRvbicpO1xuXG4gIGlmICghc3VybmFtZUlucHV0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNoZWNrVmFsaWRpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKFxuICAgICAgc3VybmFtZUlucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBuYW1lSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIHBhdHJvbnltaWNJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgY2l0eUlucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBlbWFpbElucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBjaGVja2JveC5jaGVja2VkXG4gICAgKSB7XG4gICAgICBzdWJtaXRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWJtaXRCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uSW5wdXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuXG4gICAgdmFyIGl0ZW0gPSBldnQudGFyZ2V0O1xuICAgIHZhciBsYWJlbCA9IGl0ZW0ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdwJyk7XG5cbiAgICBpZiAoIWl0ZW0udmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIGlmICghbGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgICBsYWJlbC5jbGFzc0xpc3QuYWRkKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpdGVtLmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoaXRlbS52YWxpZGl0eS52YWxpZCkge1xuICAgICAgaWYgKGxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgbGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnanMtLWVycm9yJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgb25DaGVja2JveENsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGNoZWNrVmFsaWRpdHkoKTtcblxuICAgIGlmICghY2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgaWYgKCFjaGVja2JveExhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgICAgY2hlY2tib3hMYWJlbC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFhZ3JlZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgICBhZ3JlZW1lbnQuY2xhc3NMaXN0LmFkZCgnanMtLWVycm9yJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgIGlmIChjaGVja2JveExhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgICAgY2hlY2tib3hMYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGFncmVlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGFncmVlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgb25Gb3JtU3VibWl0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tcGVyc29uYWwtZGF0YScpO1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXJlZ2lzdHJhdGlvbi1lbmQnKTtcblxuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMV0uY2xhc3NMaXN0LmFkZCgnanMtLWNoZWNrZWQnKTtcbiAgICByZWdpc3RyYXRpb25JdGVtWzJdLmNsYXNzTGlzdC5hZGQoJ2pzLS1hY3RpdmUnKTtcbiAgfTtcblxuICBzdXJuYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgbmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIHBhdHJvbnltaWNJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBjaXR5SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgZW1haWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2xpY2spO1xuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgb25Gb3JtU3VibWl0KTtcbn0pKCk7XG4iXX0=
