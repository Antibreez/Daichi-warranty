!function(){var t=document.querySelector(".authorization__form"),e=document.querySelector("input[name='name']"),n=document.querySelector("label[for='name']"),s=document.querySelector(".authorization__name-error"),o=document.querySelector("input[name='password']"),r=document.querySelector("label[for='password']"),a=document.querySelector(".authorization__password-error"),c=document.querySelector(".authorization__button");if(e&&o&&c){var i="Обязательное поле",u="Пользователь с такой электронной почтой не зарегистрирован в системе.",d=function(){return"ivanov"===e.value},l=function(){e.value.length>0&&o.value.length>0&&c.hasAttribute("disabled")&&c.removeAttribute("disabled")};c.addEventListener("click",(function(l){l.preventDefault(),""!==e.value&&""!==o.value||c.hasAttribute("disabled")||c.setAttribute("disabled",""),""===e.value?(e.classList.add("js--wrong-input"),n.classList.add("js--wrong"),s.textContent=i):d()||(e.classList.add("js--wrong-input"),n.classList.add("js--wrong"),s.textContent=u),""===o.value&&(o.classList.add("js--wrong-input"),r.classList.add("js--wrong"),a.textContent=i),e.value.length>0&&d()&&o.value.length>0&&t.submit()})),e.addEventListener("input",(function(){l(),e.classList.contains("js--wrong-input")&&e.classList.remove("js--wrong-input"),n.classList.contains("js--wrong")&&n.classList.remove("js--wrong"),s.textContent=""})),o.addEventListener("input",(function(){l(),o.classList.contains("js--wrong-input")&&o.classList.remove("js--wrong-input"),r.classList.contains("js--wrong")&&r.classList.remove("js--wrong"),a.textContent=""}))}}(),function(){var t=document.querySelector(".not-used-products__button"),e=document.querySelector(".not-used-products__show"),n=document.querySelector(".not-used-products__hide"),s=document.querySelector(".not-used-products__content"),o=document.querySelector(".account-header__dropdown"),r=document.querySelector(".account-header__nav"),a=document.querySelector(".account-header__nav-button");if(t){var c=function(t){t.classList.toggle("js--shown"),t.classList.toggle("js--hidden")};t.addEventListener("click",(function(){c(e),c(n),s.classList.toggle("js--show")})),o.addEventListener("click",(function(){r.classList.contains("js--show")||r.classList.add("js--show")})),a.addEventListener("click",(function(){r.classList.contains("js--show")&&r.classList.remove("js--show")}))}}(),function(){var t=document.querySelector(".product-registration"),e=document.querySelectorAll(".product-registration__navigation-item"),n=(document.querySelector(".contacts"),document.querySelector(".contacts__phone-number")),s=document.querySelector(".contacts__code"),o=document.querySelector("input[name='phone-number']"),r=document.querySelector("input[name='phone-code']"),a=document.querySelector(".contacts__phone-form button"),c=document.querySelector(".contacts__code-form button"),i=document.querySelector(".contacts__phone-form"),u=document.querySelector(".contacts__code-form"),d=document.querySelector(".contacts__product-card .product-card__change"),l=document.querySelector(".contacts__selected-phone"),m=document.querySelector(".contacts__code-error-message"),p=document.querySelector(".contacts__code-form label"),v=document.querySelector(".contacts__selected-phone-change"),L="Указан неверный код, осталось попыток: 1",y="Вы превысили количество попыток, следующий запрос кода возможен через 10 минут",_=0;if(o){new Inputmask("+7(999)999-99-99").mask(o),new Inputmask("9999999",{placeholder:""}).mask(r);var f=function(t){t.classList.contains("hidden")&&t.classList.remove("hidden")},g=function(t){t.classList.contains("hidden")||t.classList.add("hidden")};o.addEventListener("input",(function(){var t=o.value;16===t.length&&-1===t.indexOf("_")?a.removeAttribute("disabled"):a.setAttribute("disabled","")})),d.addEventListener("click",(function(){t.classList.remove("js--contacts"),t.classList.add("js--product-data"),e[0].classList.remove("js--checked"),e[1].classList.remove("js--active"),f(n),g(s)})),i.addEventListener("submit",(function(t){t.preventDefault(),l.textContent=o.value,g(n),f(s),r.focus()})),r.addEventListener("input",(function(){m.textContent="",p.classList.contains("js--error")&&p.classList.remove("js--error"),r.classList.contains("js--wrong-input")&&r.classList.remove("js--wrong-input"),7===r.value.length?c.removeAttribute("disabled"):c.setAttribute("disabled","")})),u.addEventListener("submit",(function(n){n.preventDefault(),"0000000"!==r.value?(p.classList.contains("js--error")||p.classList.add("js--error"),r.classList.contains("js--wrong-input")||r.classList.add("js--wrong-input"),0===_&&(m.textContent=L),_>0&&(m.textContent=y,c.setAttribute("disabled","")),_++):t.classList.contains("product-registration--account")?(t.classList.add("js--registration-end"),t.classList.remove("js--contacts"),e[0].classList.add("js--checked"),e[1].classList.add("js--active")):(t.classList.add("js--personal-data"),t.classList.remove("js--contacts"))})),v.addEventListener("click",(function(){g(s),f(n),o.focus()}))}}(),function(){var t=document.querySelector("body"),e=document.querySelector("input[name='phone-number']"),n=document.querySelector(".product-registration"),s=document.querySelectorAll(".product-registration__navigation-item"),o=(document.querySelector(".product-data"),document.querySelector(".product-data form")),r=document.querySelector("label[for='serial-number-1'] button"),a=document.querySelector(".popup-warranty"),c=document.querySelector(".popup-warranty__close"),i=document.querySelector(".popup-warranty__overlay"),u=document.querySelector(".product-data__purchase-date"),d=document.querySelector(".product-data__calendar"),l=document.querySelectorAll(".product-data__serial-number"),m=document.querySelector(".product-data__submit");if(r){var p=function(t){return/^[A-Za-z0-9]{6}/.test(t.value)},v=function(){p(l[0])&&p(l[1])&&p(l[2])&&/^[0-9.]+$/.test(u.value)?m.removeAttribute("disabled"):m.setAttribute("disabled","")},L=function(t){return Math.floor(t/10)>0?t:"0"+t},y=new Pikaday({field:d,firstDay:1,onSelect:function(){var t=new Date(y);u.value=function(t){var e=(t=new Date(t)).getDate(),n=t.getMonth()+1,s=t.getFullYear();return L(e)+"."+L(n)+"."+s}(t),v()}});new Inputmask("99.99.9999",{placeholder:"ДД.ММ.ГГГГ"}).mask(u);var _=function(t){var e=t.target;e.setCustomValidity(""),p(e)||6!==e.value.length||(e.setCustomValidity("Разрешены только латинские буквы и цыфры"),e.reportValidity()),p(e)&&6===e.value.length?(e.classList.contains("js--wrong-input")&&e.classList.remove("js--wrong-input"),"serial-number-1"!==e.id&&"serial-number-2"!==e.id||e.nextSibling.nextSibling.focus(),"serial-number-3"===e.id&&u.focus()):e.classList.add("js--wrong-input"),v()},f=function(){a.classList.add("hidden"),t.classList.remove("popup")};r.addEventListener("click",(function(){a.classList.remove("hidden"),t.classList.add("popup")})),c.addEventListener("click",(function(){f()})),i.addEventListener("click",(function(){f()})),l.forEach((function(t){t.addEventListener("input",_)})),u.addEventListener("input",(function(){v()})),o.addEventListener("submit",(function(t){t.preventDefault(),n.classList.add("js--contacts"),n.classList.remove("js--product-data"),n.classList.contains("product-registration--account")||(s[0].classList.add("js--checked"),s[1].classList.add("js--active")),e.focus()}))}}(),function(){var t=document.querySelector(".product-registration"),e=document.querySelectorAll(".product-registration__navigation-item"),n=document.querySelector(".personal-data__form"),s=document.querySelector(".personal-data input[name='surname']"),o=document.querySelector(".personal-data input[name='name']"),r=document.querySelector(".personal-data input[name='patronymic']"),a=document.querySelector(".personal-data input[name='city']"),c=document.querySelector(".personal-data input[name='email']"),i=document.querySelector(".personal-data input[type='checkbox']"),u=document.querySelector(".personal-data__agreement-wrapper label"),d=document.querySelector(".personal-data__text-wrapper"),l=document.querySelector(".personal-data__button");if(s){var m=function(){s.validity.valid&&o.validity.valid&&r.validity.valid&&a.validity.valid&&c.validity.valid&&i.checked?l.removeAttribute("disabled"):l.setAttribute("disabled","")},p=function(t){m();var e=t.target,n=e.parentNode.querySelector("p");e.validity.valid||(n.classList.contains("js--error")||n.classList.add("js--error"),e.classList.contains("js--wrong-input")||e.classList.add("js--wrong-input")),e.validity.valid&&(n.classList.contains("js--error")&&n.classList.remove("js--error"),e.classList.contains("js--wrong-input")&&e.classList.remove("js--wrong-input"))};s.addEventListener("input",p),o.addEventListener("input",p),r.addEventListener("input",p),a.addEventListener("input",p),c.addEventListener("input",p),i.addEventListener("change",(function(){m(),i.checked||(u.classList.contains("js--wrong-input")||u.classList.add("js--wrong-input"),d.classList.contains("js--error")||d.classList.add("js--error")),i.checked&&(u.classList.contains("js--wrong-input")&&u.classList.remove("js--wrong-input"),d.classList.contains("js--error")&&d.classList.remove("js--error"))})),n.addEventListener("submit",(function(n){n.preventDefault(),t.classList.remove("js--personal-data"),t.classList.add("js--registration-end"),e[1].classList.add("js--checked"),e[2].classList.add("js--active")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiLCJhY2NvdW50LmpzIiwiY29udGFjdHMuanMiLCJwcm9kdWN0LWRhdGEuanMiLCJwZXJzb25hbC1kYXRhLmpzIl0sIm5hbWVzIjpbImZvcm0iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJuYW1lSW5wdXQiLCJuYW1lTGFiZWwiLCJuYW1lTWVzc2FnZSIsInBhc3N3b3JkSW5wdXQiLCJwYXNzd29yZExhYmVsIiwicGFzc3dvcmRNZXNzYWdlIiwic3VibWl0QnV0dG9uIiwiRVJST1JfTUVTU0FHRSIsImlzTmFtZUV4aXN0IiwidmFsdWUiLCJjaGVja1ZhbHVlcyIsImxlbmd0aCIsImhhc0F0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInNldEF0dHJpYnV0ZSIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50Iiwic3VibWl0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJvbGRQcm9kdWN0c0J1dHRvbiIsIm9sZFByb2R1Y3RzU2hvdyIsIm9sZFByb2R1Y3RzSGlkZSIsIm9sZFByb2R1Y3RzIiwiZHJvcGRvd24iLCJuYXZpZ2F0aW9uIiwiY2xvc2VOYXZCdXR0b24iLCJvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZSIsIml0ZW0iLCJ0b2dnbGUiLCJwcm9kdWN0UmVnaXN0cmF0aW9uIiwicmVnaXN0cmF0aW9uSXRlbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb250YWN0c1Bob25lIiwiY29udGFjdHNDb2RlIiwicGhvbmVJbnB1dCIsImNvZGVJbnB1dCIsInBob25lQnV0dG9uIiwiY29kZUJ1dHRvbiIsInBob25lRm9ybSIsImNvZGVGb3JtIiwicHJvZHVjdENoYW5nZUJ1dHRvbiIsInNlbGVjdGVkUGhvbmUiLCJjb2RlRXJyb3IiLCJjb2RlTGFiZWwiLCJwaG9uZUNoYW5nZUJ1dHRvbiIsIkVSUk9SX01FU1NBR0VTIiwiYXR0ZW1wdHMiLCJJbnB1dG1hc2siLCJtYXNrIiwicGxhY2Vob2xkZXIiLCJzaG93IiwiaGlkZSIsInN0ciIsImluZGV4T2YiLCJmb2N1cyIsImJvZHkiLCJwcm9kdWN0RGF0YUZvcm0iLCJ3YXJyYW50eUNvZGVCdXR0b24iLCJwb3B1cCIsInBvcHVwQ2xvc2UiLCJwb3B1cE92ZXJsYXkiLCJjYWxlbmRhcklucHV0IiwiY2FsZW5kYXJCdXR0b24iLCJzZXJpYWxOdW1iZXJJbnB1dCIsImRhdGFTdWJtaXQiLCJpc1NlcmlhbE51bWJlclZhbGlkIiwidGFyZ2V0IiwidGVzdCIsImNoZWNrVmFsaWRpdHkiLCJnZXRDb3JyZWN0TnVtYmVyIiwibnVtIiwiTWF0aCIsImZsb29yIiwicGlja2VyIiwiUGlrYWRheSIsImZpZWxkIiwiZmlyc3REYXkiLCJvblNlbGVjdCIsImRhdGUiLCJEYXRlIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJvblNlcmlhbE51bWJlcklucHV0Iiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJyZXBvcnRWYWxpZGl0eSIsImlkIiwibmV4dFNpYmxpbmciLCJjbG9zZVBvcHVwIiwiZm9yRWFjaCIsImVsIiwic3VybmFtZUlucHV0IiwicGF0cm9ueW1pY0lucHV0IiwiY2l0eUlucHV0IiwiZW1haWxJbnB1dCIsImNoZWNrYm94IiwiY2hlY2tib3hMYWJlbCIsImFncmVlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJjaGVja2VkIiwib25JbnB1dCIsImxhYmVsIiwicGFyZW50Tm9kZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxJQUFBQSxFQUFBQyxTQUFBQyxjQUFBLHdCQUNBQyxFQUFBRixTQUFBQyxjQUFBLHNCQUNBRSxFQUFBSCxTQUFBQyxjQUFBLHFCQUNBRyxFQUFBSixTQUFBQyxjQUFBLDhCQUNBSSxFQUFBTCxTQUFBQyxjQUFBLDBCQUNBSyxFQUFBTixTQUFBQyxjQUFBLHlCQUNBTSxFQUFBUCxTQUFBQyxjQUFBLGtDQUNBTyxFQUFBUixTQUFBQyxj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QWtCLEVBQUFoQixVQUFBSyxPQUFBLHFCQUNBVyxFQUFBaEIsVUFBQUMsSUFBQSx3QkFFQWdCLEVBQUEsR0FBQWpCLFVBQUFDLElBQUEsZUFDQWdCLEVBQUEsR0FBQWpCLFVBQUFDLElBQUEsa0JBNUZBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICB2YXIgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRob3JpemF0aW9uX19mb3JtJyk7XG4gIHZhciBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0nbmFtZSddXCIpO1xuICB2YXIgbmFtZUxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj0nbmFtZSddXCIpO1xuICB2YXIgbmFtZU1lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXV0aG9yaXphdGlvbl9fbmFtZS1lcnJvcicpO1xuICB2YXIgcGFzc3dvcmRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xuICB2YXIgcGFzc3dvcmRMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFtmb3I9J3Bhc3N3b3JkJ11cIik7XG4gIHZhciBwYXNzd29yZE1lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXV0aG9yaXphdGlvbl9fcGFzc3dvcmQtZXJyb3InKTtcbiAgdmFyIHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRob3JpemF0aW9uX19idXR0b24nKTtcblxuICBpZiAoIW5hbWVJbnB1dCB8fCAhcGFzc3dvcmRJbnB1dCB8fCAhc3VibWl0QnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIEVSUk9SX01FU1NBR0UgPSB7XG4gICAgZW1wdHk6ICfQntCx0Y/Qt9Cw0YLQtdC70YzQvdC+0LUg0L/QvtC70LUnLFxuICAgIG5vdEZvdW5kOiAn0J/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINGBINGC0LDQutC+0Lkg0Y3Qu9C10LrRgtGA0L7QvdC90L7QuSDQv9C+0YfRgtC+0Lkg0L3QtSDQt9Cw0YDQtdCz0LjRgdGC0YDQuNGA0L7QstCw0L0g0LIg0YHQuNGB0YLQtdC80LUuJ1xuICB9O1xuXG4gIHZhciBpc05hbWVFeGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmFtZUlucHV0LnZhbHVlID09PSAnaXZhbm92JztcbiAgfTtcblxuICB2YXIgY2hlY2tWYWx1ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKG5hbWVJbnB1dC52YWx1ZS5sZW5ndGggPiAwICYmIHBhc3N3b3JkSW5wdXQudmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKHN1Ym1pdEJ1dHRvbi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgb25TdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBpZiAobmFtZUlucHV0LnZhbHVlID09PSAnJyB8fCBwYXNzd29yZElucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgaWYgKCFzdWJtaXRCdXR0b24uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChuYW1lSW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICBuYW1lSW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICBuYW1lTGFiZWwuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nJyk7XG4gICAgICBuYW1lTWVzc2FnZS50ZXh0Q29udGVudCA9IEVSUk9SX01FU1NBR0UuZW1wdHk7XG4gICAgfSBlbHNlIGlmICghaXNOYW1lRXhpc3QoKSkge1xuICAgICAgbmFtZUlucHV0LmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgbmFtZUxhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZycpO1xuICAgICAgbmFtZU1lc3NhZ2UudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFLm5vdEZvdW5kO1xuICAgIH1cblxuICAgIGlmIChwYXNzd29yZElucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgcGFzc3dvcmRJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIHBhc3N3b3JkTGFiZWwuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nJyk7XG4gICAgICBwYXNzd29yZE1lc3NhZ2UudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFLmVtcHR5O1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgIG5hbWVJbnB1dC52YWx1ZS5sZW5ndGggPiAwXG4gICAgICAmJiBpc05hbWVFeGlzdCgpXG4gICAgICAmJiBwYXNzd29yZElucHV0LnZhbHVlLmxlbmd0aCA+IDBcbiAgICApIHtcblxuICAgICAgZm9ybS5zdWJtaXQoKTtcbiAgICB9XG4gIH1cblxuICB2YXIgb25OYW1lSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2hlY2tWYWx1ZXMoKTtcblxuICAgIGlmIChuYW1lSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgbmFtZUlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgIH1cblxuICAgIGlmIChuYW1lTGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmcnKSkge1xuICAgICAgbmFtZUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZycpO1xuICAgIH1cblxuICAgIG5hbWVNZXNzYWdlLnRleHRDb250ZW50ID0gJyc7XG4gIH07XG5cbiAgdmFyIG9uUGFzc3dvcmRJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjaGVja1ZhbHVlcygpO1xuXG4gICAgaWYgKHBhc3N3b3JkSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgcGFzc3dvcmRJbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG5cbiAgICBpZiAocGFzc3dvcmRMYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZycpKSB7XG4gICAgICBwYXNzd29yZExhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZycpO1xuICAgIH1cblxuICAgIHBhc3N3b3JkTWVzc2FnZS50ZXh0Q29udGVudCA9ICcnO1xuICB9O1xuXG4gIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uU3VibWl0KTtcbiAgbmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25OYW1lSW5wdXQpO1xuICBwYXNzd29yZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25QYXNzd29yZElucHV0KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICB2YXIgb2xkUHJvZHVjdHNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90LXVzZWQtcHJvZHVjdHNfX2J1dHRvbicpO1xuICB2YXIgb2xkUHJvZHVjdHNTaG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19zaG93Jyk7XG4gIHZhciBvbGRQcm9kdWN0c0hpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubm90LXVzZWQtcHJvZHVjdHNfX2hpZGUnKTtcbiAgdmFyIG9sZFByb2R1Y3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19jb250ZW50Jyk7XG4gIHZhciBkcm9wZG93biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY2NvdW50LWhlYWRlcl9fZHJvcGRvd24nKTtcbiAgdmFyIG5hdmlnYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWNjb3VudC1oZWFkZXJfX25hdicpO1xuICB2YXIgY2xvc2VOYXZCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWNjb3VudC1oZWFkZXJfX25hdi1idXR0b24nKTtcblxuICBpZiAoIW9sZFByb2R1Y3RzQnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG9sZFByb2R1Y3RzQnV0dG9uVG9nZ2xlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2pzLS1zaG93bicpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnanMtLWhpZGRlbicpO1xuICB9O1xuXG4gIHZhciBvbk9sZFByb2R1Y3RzQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUob2xkUHJvZHVjdHNTaG93KTtcbiAgICBvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZShvbGRQcm9kdWN0c0hpZGUpO1xuICAgIG9sZFByb2R1Y3RzLmNsYXNzTGlzdC50b2dnbGUoJ2pzLS1zaG93Jyk7XG4gIH07XG5cbiAgdmFyIG9uRHJvcGRvd25DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIW5hdmlnYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tc2hvdycpKSB7XG4gICAgICBuYXZpZ2F0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1zaG93Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uTmF2Q2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAobmF2aWdhdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1zaG93JykpIHtcbiAgICAgIG5hdmlnYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXNob3cnKTtcbiAgICB9XG4gIH1cblxuICBvbGRQcm9kdWN0c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT2xkUHJvZHVjdHNCdXR0b25DbGljayk7XG4gIGRyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Ecm9wZG93bkNsaWNrKTtcbiAgY2xvc2VOYXZCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk5hdkNsb3NlQ2xpY2spO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIHZhciBwcm9kdWN0UmVnaXN0cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgY29udGFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHMnKTtcbiAgdmFyIGNvbnRhY3RzUGhvbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3Bob25lLW51bWJlcicpO1xuICB2YXIgY29udGFjdHNDb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlJyk7XG4gIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLW51bWJlciddXCIpO1xuICB2YXIgY29kZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLWNvZGUnXVwiKVxuICB2YXIgcGhvbmVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3Bob25lLWZvcm0gYnV0dG9uJyk7XG4gIHZhciBjb2RlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlLWZvcm0gYnV0dG9uJylcbiAgdmFyIHBob25lRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtZm9ybScpO1xuICB2YXIgY29kZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybScpO1xuICB2YXIgcHJvZHVjdENoYW5nZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcHJvZHVjdC1jYXJkIC5wcm9kdWN0LWNhcmRfX2NoYW5nZScpO1xuICB2YXIgc2VsZWN0ZWRQaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fc2VsZWN0ZWQtcGhvbmUnKTtcbiAgdmFyIGNvZGVFcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1lcnJvci1tZXNzYWdlJyk7XG4gIHZhciBjb2RlTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybSBsYWJlbCcpO1xuICB2YXIgcGhvbmVDaGFuZ2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX3NlbGVjdGVkLXBob25lLWNoYW5nZScpO1xuXG4gIHZhciBDT1JSRUNUX0NPREUgPSAnMDAwMDAwMCc7XG4gIHZhciBFUlJPUl9NRVNTQUdFUyA9IHtcbiAgICBmaXJzdDogJ9Cj0LrQsNC30LDQvSDQvdC10LLQtdGA0L3Ri9C5INC60L7QtCwg0L7RgdGC0LDQu9C+0YHRjCDQv9C+0L/Ri9GC0L7QujogMScsXG4gICAgc2Vjb25kOiAn0JLRiyDQv9GA0LXQstGL0YHQuNC70Lgg0LrQvtC70LjRh9C10YHRgtCy0L4g0L/QvtC/0YvRgtC+0LosINGB0LvQtdC00YPRjtGJ0LjQuSDQt9Cw0L/RgNC+0YEg0LrQvtC00LAg0LLQvtC30LzQvtC20LXQvSDRh9C10YDQtdC3IDEwINC80LjQvdGD0YInXG4gIH07XG5cbiAgdmFyIGF0dGVtcHRzID0gMDtcblxuICBpZiAoIXBob25lSW5wdXQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW1QaG9uZSA9IG5ldyBJbnB1dG1hc2soJys3KDk5OSk5OTktOTktOTknKTtcbiAgaW1QaG9uZS5tYXNrKHBob25lSW5wdXQpO1xuXG4gIHZhciBpbUNvZGUgPSBuZXcgSW5wdXRtYXNrKCc5OTk5OTk5JywgeyBwbGFjZWhvbGRlcjogJycgfSk7XG4gIGltQ29kZS5tYXNrKGNvZGVJbnB1dCk7XG5cbiAgdmFyIHNob3cgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIHtcbiAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBoaWRlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNsZWFyRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29kZUVycm9yLnRleHRDb250ZW50ID0gJyc7XG5cbiAgICBpZiAoY29kZUxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgIGNvZGVMYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZXJyb3InKTtcbiAgICB9XG5cbiAgICBpZiAoY29kZUlucHV0LmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgIGNvZGVJbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uUGhvbmVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc3RyID0gcGhvbmVJbnB1dC52YWx1ZTtcbiAgICBpZiAoc3RyLmxlbmd0aCA9PT0gMTYgJiYgc3RyLmluZGV4T2YoJ18nKSA9PT0gLTEpIHtcbiAgICAgIHBob25lQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGhvbmVCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uUHJvZHVjdENoYW5nZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLWNvbnRhY3RzJyk7XG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QuYWRkKCdqcy0tcHJvZHVjdC1kYXRhJyk7XG5cbiAgICByZWdpc3RyYXRpb25JdGVtWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1jaGVja2VkJyk7XG4gICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tYWN0aXZlJyk7XG5cbiAgICBzaG93KGNvbnRhY3RzUGhvbmUpO1xuICAgIGhpZGUoY29udGFjdHNDb2RlKTtcbiAgfTtcblxuICB2YXIgb25QaG9uZVN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBzZWxlY3RlZFBob25lLnRleHRDb250ZW50ID0gcGhvbmVJbnB1dC52YWx1ZTtcbiAgICBoaWRlKGNvbnRhY3RzUGhvbmUpO1xuICAgIHNob3coY29udGFjdHNDb2RlKTtcblxuICAgIGNvZGVJbnB1dC5mb2N1cygpO1xuICB9O1xuXG4gIHZhciBvblBob25lQ2hhbmdlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgaGlkZShjb250YWN0c0NvZGUpO1xuICAgIHNob3coY29udGFjdHNQaG9uZSk7XG5cbiAgICBwaG9uZUlucHV0LmZvY3VzKCk7XG4gIH1cblxuICB2YXIgb25Db2RlSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2xlYXJFcnJvcigpO1xuICAgIGlmIChjb2RlSW5wdXQudmFsdWUubGVuZ3RoID09PSA3KSB7XG4gICAgICBjb2RlQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29kZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBvbkNvZGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKGNvZGVJbnB1dC52YWx1ZSAhPT0gQ09SUkVDVF9DT0RFKSB7XG4gICAgICBpZiAoIWNvZGVMYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGNvZGVMYWJlbC5jbGFzc0xpc3QuYWRkKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFjb2RlSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjb2RlSW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhdHRlbXB0cyA9PT0gMCkge1xuICAgICAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFUy5maXJzdDtcbiAgICAgIH1cblxuICAgICAgaWYgKGF0dGVtcHRzID4gMCkge1xuICAgICAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSBFUlJPUl9NRVNTQUdFUy5zZWNvbmQ7XG4gICAgICAgIGNvZGVCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICAgIH1cblxuICAgICAgYXR0ZW1wdHMrKztcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdwcm9kdWN0LXJlZ2lzdHJhdGlvbi0tYWNjb3VudCcpKSB7XG4gICAgICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXJlZ2lzdHJhdGlvbi1lbmQnKTtcbiAgICAgICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcblxuICAgICAgICByZWdpc3RyYXRpb25JdGVtWzBdLmNsYXNzTGlzdC5hZGQoJ2pzLS1jaGVja2VkJyk7XG4gICAgICAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5hZGQoJ2pzLS1hY3RpdmUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXBlcnNvbmFsLWRhdGEnKTtcbiAgICAgICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcGhvbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uUGhvbmVJbnB1dCk7XG4gIHByb2R1Y3RDaGFuZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblByb2R1Y3RDaGFuZ2VDbGljayk7XG4gIHBob25lRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvblBob25lU3VibWl0KTtcbiAgY29kZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25Db2RlSW5wdXQpO1xuICBjb2RlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbkNvZGVTdWJtaXQpO1xuICBwaG9uZUNoYW5nZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUGhvbmVDaGFuZ2VDbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLW51bWJlciddXCIpO1xuXG4gIHZhciBwcm9kdWN0UmVnaXN0cmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgcHJvZHVjdERhdGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhJyk7XG4gIHZhciBwcm9kdWN0RGF0YUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhIGZvcm0nKTtcbiAgdmFyIHdhcnJhbnR5Q29kZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFtmb3I9J3NlcmlhbC1udW1iZXItMSddIGJ1dHRvblwiKTtcbiAgdmFyIHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5Jyk7XG4gIHZhciBwb3B1cENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5X19jbG9zZScpO1xuICB2YXIgcG9wdXBPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXdhcnJhbnR5X19vdmVybGF5Jyk7XG5cbiAgdmFyIGNhbGVuZGFySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1kYXRhX19wdXJjaGFzZS1kYXRlJyk7XG4gIHZhciBjYWxlbmRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGFfX2NhbGVuZGFyJyk7XG5cbiAgdmFyIHNlcmlhbE51bWJlcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnByb2R1Y3QtZGF0YV9fc2VyaWFsLW51bWJlcicpO1xuICB2YXIgZGF0YVN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGFfX3N1Ym1pdCcpO1xuXG4gIGlmKCF3YXJyYW50eUNvZGVCdXR0b24pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaXNTZXJpYWxOdW1iZXJWYWxpZCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICByZXR1cm4gKC9eW0EtWmEtejAtOV17Nn0vKS50ZXN0KHRhcmdldC52YWx1ZSk7XG4gIH07XG5cbiAgdmFyIGlzQ2FsZW5kYXJWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKC9eWzAtOS5dKyQvKS50ZXN0KGNhbGVuZGFySW5wdXQudmFsdWUpO1xuICB9O1xuXG4gIHZhciBjaGVja1ZhbGlkaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmKFxuICAgICAgaXNTZXJpYWxOdW1iZXJWYWxpZChzZXJpYWxOdW1iZXJJbnB1dFswXSlcbiAgICAgICYmIGlzU2VyaWFsTnVtYmVyVmFsaWQoc2VyaWFsTnVtYmVySW5wdXRbMV0pXG4gICAgICAmJiBpc1NlcmlhbE51bWJlclZhbGlkKHNlcmlhbE51bWJlcklucHV0WzJdKVxuICAgICAgJiYgaXNDYWxlbmRhclZhbGlkKClcbiAgICApIHtcbiAgICAgIGRhdGFTdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhU3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBnZXRDb3JyZWN0TnVtYmVyID0gZnVuY3Rpb24gKG51bSkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKG51bSAvIDEwKSA+IDAgPyBudW0gOiAnMCcgKyBudW07XG4gIH07XG5cbiAgdmFyIGdldERhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZSk7XG5cbiAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcblxuICAgIHJldHVybiBnZXRDb3JyZWN0TnVtYmVyKGRheSkgKyAnLicgKyBnZXRDb3JyZWN0TnVtYmVyKG1vbnRoKSArICcuJyArIHllYXI7XG4gIH07XG5cbiAgdmFyIHBpY2tlciA9IG5ldyBQaWthZGF5KHtcbiAgICBmaWVsZDogY2FsZW5kYXJCdXR0b24sXG4gICAgZmlyc3REYXk6IDEsXG4gICAgb25TZWxlY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShwaWNrZXIpO1xuICAgICAgY2FsZW5kYXJJbnB1dC52YWx1ZSA9IGdldERhdGUoZGF0ZSk7XG4gICAgICBjaGVja1ZhbGlkaXR5KCk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKCc5OS45OS45OTk5JywgeyAncGxhY2Vob2xkZXInOiAn0JTQlC7QnNCcLtCT0JPQk9CTJ30pO1xuICBpbS5tYXNrKGNhbGVuZGFySW5wdXQpO1xuXG4gIHZhciBvblNlcmlhbE51bWJlcklucHV0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgdGFyZ2V0LnNldEN1c3RvbVZhbGlkaXR5KCcnKTtcblxuICAgIGlmKCFpc1NlcmlhbE51bWJlclZhbGlkKHRhcmdldCkgJiYgdGFyZ2V0LnZhbHVlLmxlbmd0aCA9PT0gNikge1xuICAgICAgdGFyZ2V0LnNldEN1c3RvbVZhbGlkaXR5KCfQoNCw0LfRgNC10YjQtdC90Ysg0YLQvtC70YzQutC+INC70LDRgtC40L3RgdC60LjQtSDQsdGD0LrQstGLINC4INGG0YvRhNGA0YsnKTtcbiAgICAgIHRhcmdldC5yZXBvcnRWYWxpZGl0eSgpO1xuICAgIH1cblxuICAgIGlmIChpc1NlcmlhbE51bWJlclZhbGlkKHRhcmdldCkgJiYgdGFyZ2V0LnZhbHVlLmxlbmd0aCA9PT0gNikge1xuICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRhcmdldC5pZCA9PT0gJ3NlcmlhbC1udW1iZXItMScgfHwgdGFyZ2V0LmlkID09PSAnc2VyaWFsLW51bWJlci0yJykge1xuICAgICAgICB0YXJnZXQubmV4dFNpYmxpbmcubmV4dFNpYmxpbmcuZm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRhcmdldC5pZCA9PT0gJ3NlcmlhbC1udW1iZXItMycpIHtcbiAgICAgICAgY2FsZW5kYXJJbnB1dC5mb2N1cygpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuXG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuICB9O1xuXG4gIC8vIHZhciBvbklucHV0Qmx1ciA9IGZ1bmN0aW9uIChldnQpIHtcbiAgLy8gICB2YXIgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcblxuICAvLyAgIGlmICh0YXJnZXQudmFsdWUubGVuZ3RoIDwgNikge1xuICAvLyAgICAgdGFyZ2V0LnNldEN1c3RvbVZhbGlkaXR5KCfQktCy0LXQtNC40YLQtSA2INGB0LjQvNCy0L7Qu9C+0LInKTtcbiAgLy8gICAgIHRhcmdldC5yZXBvcnRWYWxpZGl0eSgpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIHZhciBvbkNhbGVuZGFySW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuICB9O1xuXG4gIHZhciBvcGVuUG9wdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdwb3B1cCcpO1xuICB9O1xuXG4gIHZhciBjbG9zZVBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXAnKTtcbiAgfVxuXG4gIHZhciBvbldhcnJhbnR5Q29kZUJ1dHRvbkNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIG9wZW5Qb3B1cCgpO1xuICB9O1xuXG4gIHZhciBvblBvcHVwQ2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbG9zZVBvcHVwKCk7XG4gIH07XG5cbiAgdmFyIG9uUG9wdXBPdmVybGF5Q2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2xvc2VQb3B1cCgpO1xuICB9O1xuXG4gIHZhciBvblN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1jb250YWN0cycpO1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXByb2R1Y3QtZGF0YScpO1xuXG4gICAgaWYgKCFwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5jb250YWlucygncHJvZHVjdC1yZWdpc3RyYXRpb24tLWFjY291bnQnKSkge1xuICAgICAgcmVnaXN0cmF0aW9uSXRlbVswXS5jbGFzc0xpc3QuYWRkKCdqcy0tY2hlY2tlZCcpO1xuICAgICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QuYWRkKCdqcy0tYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgcGhvbmVJbnB1dC5mb2N1cygpO1xuICB9O1xuXG4gIHdhcnJhbnR5Q29kZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uV2FycmFudHlDb2RlQnV0dG9uQ2xpY2spO1xuICBwb3B1cENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Qb3B1cENsb3NlQ2xpY2spO1xuICBwb3B1cE92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblBvcHVwT3ZlcmxheUNsaWNrKTtcblxuICBzZXJpYWxOdW1iZXJJbnB1dC5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25TZXJpYWxOdW1iZXJJbnB1dCk7XG4gICAgLy9lbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25JbnB1dEJsdXIpO1xuICB9KTtcblxuICBjYWxlbmRhcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25DYWxlbmRhcklucHV0KTtcbiAgcHJvZHVjdERhdGFGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIG9uU3VibWl0KTtcbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICB2YXIgcHJvZHVjdFJlZ2lzdHJhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LXJlZ2lzdHJhdGlvbicpO1xuICB2YXIgcmVnaXN0cmF0aW9uSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9kdWN0LXJlZ2lzdHJhdGlvbl9fbmF2aWdhdGlvbi1pdGVtJyk7XG5cbiAgdmFyIGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyc29uYWwtZGF0YV9fZm9ybScpO1xuICB2YXIgc3VybmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J3N1cm5hbWUnXVwiKTtcbiAgdmFyIG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSduYW1lJ11cIik7XG4gIHZhciBwYXRyb255bWljSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0ncGF0cm9ueW1pYyddXCIpO1xuICB2YXIgY2l0eUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J2NpdHknXVwiKTtcbiAgdmFyIGVtYWlsSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nZW1haWwnXVwiKTtcbiAgdmFyIGNoZWNrYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W3R5cGU9J2NoZWNrYm94J11cIik7XG4gIHZhciBjaGVja2JveExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlcnNvbmFsLWRhdGFfX2FncmVlbWVudC13cmFwcGVyIGxhYmVsJyk7XG4gIHZhciBhZ3JlZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGFfX3RleHQtd3JhcHBlclwiKTtcbiAgdmFyIHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZXJzb25hbC1kYXRhX19idXR0b24nKTtcblxuICBpZiAoIXN1cm5hbWVJbnB1dCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjaGVja1ZhbGlkaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChcbiAgICAgIHN1cm5hbWVJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgbmFtZUlucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBwYXRyb255bWljSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGNpdHlJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgZW1haWxJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgY2hlY2tib3guY2hlY2tlZFxuICAgICkge1xuICAgICAgc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VibWl0QnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbklucHV0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIGNoZWNrVmFsaWRpdHkoKTtcblxuICAgIHZhciBpdGVtID0gZXZ0LnRhcmdldDtcbiAgICB2YXIgbGFiZWwgPSBpdGVtLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcigncCcpO1xuXG4gICAgaWYgKCFpdGVtLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICBpZiAoIWxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgbGFiZWwuY2xhc3NMaXN0LmFkZCgnanMtLWVycm9yJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGl0ZW0udmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIGlmIChsYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uQ2hlY2tib3hDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBjaGVja1ZhbGlkaXR5KCk7XG5cbiAgICBpZiAoIWNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgIGlmICghY2hlY2tib3hMYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghYWdyZWVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgYWdyZWVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICBpZiAoY2hlY2tib3hMYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhZ3JlZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgICBhZ3JlZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanMtLWVycm9yJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uRm9ybVN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXBlcnNvbmFsLWRhdGEnKTtcbiAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1yZWdpc3RyYXRpb24tZW5kJyk7XG5cbiAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5hZGQoJ2pzLS1jaGVja2VkJyk7XG4gICAgcmVnaXN0cmF0aW9uSXRlbVsyXS5jbGFzc0xpc3QuYWRkKCdqcy0tYWN0aXZlJyk7XG4gIH07XG5cbiAgc3VybmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIG5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBwYXRyb255bWljSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgY2l0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIGVtYWlsSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25DaGVja2JveENsaWNrKTtcblxuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIG9uRm9ybVN1Ym1pdCk7XG59KSgpO1xuIl19
