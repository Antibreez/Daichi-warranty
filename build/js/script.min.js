!function(){var e=document.querySelector("input[name='name']"),t=document.querySelector("input[name='password']"),n=document.querySelector(".authorization__button");if(e&&t&&n){var s=function(e){var t=e.target;t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input")};n.addEventListener("click",(function(){""===e.value&&e.classList.add("js--wrong-input"),""===t.value&&t.classList.add("js--wrong-input")})),e.addEventListener("input",s),t.addEventListener("input",s)}}(),function(){var e=document.querySelector(".not-used-products__button"),t=document.querySelector(".not-used-products__show"),n=document.querySelector(".not-used-products__hide"),s=document.querySelector(".not-used-products__content");if(e){var r=function(e){e.classList.toggle("shown"),e.classList.toggle("hidden")};e.addEventListener("click",(function(){r(t),r(n),s.classList.toggle("show")}))}}(),function(){var e=document.querySelector(".product-registration"),t=document.querySelectorAll(".product-registration__navigation-item"),n=(document.querySelector(".contacts"),document.querySelector(".contacts__phone-number")),s=document.querySelector(".contacts__code"),r=document.querySelector("input[name='phone-number']"),o=document.querySelector("input[name='phone-code']"),a=document.querySelector(".contacts__phone-form button"),c=document.querySelector(".contacts__code-form button"),i=document.querySelector(".contacts__phone-form"),u=document.querySelector(".contacts__code-form"),d=document.querySelector(".contacts__product-card .product-card__change"),l=document.querySelector(".contacts__selected-phone"),m=document.querySelector(".contacts__code-error-message"),p=document.querySelector(".contacts__code-form label"),v=document.querySelector(".contacts__selected-phone-change"),L="Указан неверный код, осталось попыток: 1",y="Вы превысили количество попыток, следующий запрос кода возможен через 10 минут",_=0;if(r){new Inputmask("+7(999)999-99-99").mask(r),new Inputmask("9999999",{placeholder:""}).mask(o);var f=function(e){e.classList.contains("hidden")&&e.classList.remove("hidden")},g=function(e){e.classList.contains("hidden")||e.classList.add("hidden")};r.addEventListener("input",(function(){var e=r.value;16===e.length&&-1===e.indexOf("_")?a.removeAttribute("disabled"):a.setAttribute("disabled","")})),d.addEventListener("click",(function(){e.classList.remove("js--contacts"),e.classList.add("js--product-data"),t[0].classList.remove("js--checked"),t[1].classList.remove("js--active"),f(n),g(s)})),i.addEventListener("submit",(function(e){e.preventDefault(),l.textContent=r.value,g(n),f(s),o.focus()})),o.addEventListener("input",(function(){m.textContent="",p.classList.contains("js--error")&&p.classList.remove("js--error"),o.classList.contains("js--wrong-input")&&o.classList.remove("js--wrong-input"),7===o.value.length?c.removeAttribute("disabled"):c.setAttribute("disabled","")})),u.addEventListener("submit",(function(t){t.preventDefault(),"0000000"!==o.value?(p.classList.contains("js--error")||p.classList.add("js--error"),o.classList.contains("js--wrong-input")||o.classList.add("js--wrong-input"),0===_&&(m.textContent=L),_>0&&(m.textContent=y,c.setAttribute("disabled","")),_++):(e.classList.add("js--personal-data"),e.classList.remove("js--contacts"))})),v.addEventListener("click",(function(){g(s),f(n),r.focus()}))}}(),function(){var e=document.querySelector("body"),t=document.querySelector("input[name='phone-number']"),n=document.querySelector(".product-registration"),s=document.querySelectorAll(".product-registration__navigation-item"),r=(document.querySelector(".product-data"),document.querySelector(".product-data form")),o=document.querySelector("label[for='serial-number-1'] button"),a=document.querySelector(".popup-warranty"),c=document.querySelector(".popup-warranty__close"),i=document.querySelector(".popup-warranty__overlay"),u=document.querySelector(".product-data__purchase-date"),d=document.querySelector(".product-data__calendar"),l=document.querySelectorAll(".product-data__serial-number"),m=document.querySelector(".product-data__submit");if(o){var p=function(){6===l[0].value.length&&6===l[1].value.length&&6===l[2].value.length&&/^[0-9.]+$/.test(u.value)?m.removeAttribute("disabled"):m.setAttribute("disabled","")},v=function(e){return Math.floor(e/10)>0?e:"0"+e},L=new Pikaday({field:d,firstDay:1,onSelect:function(){var e=new Date(L);u.value=function(e){var t=(e=new Date(e)).getDate(),n=e.getMonth()+1,s=e.getFullYear();return v(t)+"."+v(n)+"."+s}(e),p()}});new Inputmask("99.99.9999",{placeholder:"ДД.ММ.ГГГГ"}).mask(u);var y=function(e){var t=e.target;6===t.value.length?(t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"),"serial-number-1"!==t.id&&"serial-number-2"!==t.id||t.nextSibling.nextSibling.focus(),"serial-number-3"===t.id&&u.focus()):t.classList.add("js--wrong-input"),p()},_=function(){a.classList.add("hidden"),e.classList.remove("popup")};o.addEventListener("click",(function(){a.classList.remove("hidden"),e.classList.add("popup")})),c.addEventListener("click",(function(){_()})),i.addEventListener("click",(function(){_()})),l.forEach((function(e){e.addEventListener("input",y)})),u.addEventListener("input",(function(){p(),console.log(u.value.length)})),r.addEventListener("submit",(function(e){e.preventDefault(),n.classList.add("js--contacts"),n.classList.remove("js--product-data"),s[0].classList.add("js--checked"),s[1].classList.add("js--active"),t.focus()}))}}(),function(){var e=document.querySelector(".product-registration"),t=document.querySelectorAll(".product-registration__navigation-item"),n=document.querySelector(".personal-data__form"),s=document.querySelector(".personal-data input[name='surname']"),r=document.querySelector(".personal-data input[name='name']"),o=document.querySelector(".personal-data input[name='patronymic']"),a=document.querySelector(".personal-data input[name='city']"),c=document.querySelector(".personal-data input[name='email']"),i=document.querySelector(".personal-data input[type='checkbox']"),u=document.querySelector(".personal-data__agreement-wrapper label"),d=document.querySelector(".personal-data__text-wrapper"),l=document.querySelector(".personal-data__button");if(s){var m=function(){s.validity.valid&&r.validity.valid&&o.validity.valid&&a.validity.valid&&c.validity.valid&&i.checked?l.removeAttribute("disabled"):l.setAttribute("disabled","")},p=function(e){m();var t=e.target,n=t.parentNode.querySelector("p");t.validity.valid||(n.classList.contains("js--error")||n.classList.add("js--error"),t.classList.contains("js--wrong-input")||t.classList.add("js--wrong-input")),t.validity.valid&&(n.classList.contains("js--error")&&n.classList.remove("js--error"),t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"))};s.addEventListener("input",p),r.addEventListener("input",p),o.addEventListener("input",p),a.addEventListener("input",p),c.addEventListener("input",p),i.addEventListener("change",(function(){m(),i.checked||(u.classList.contains("js--wrong-input")||u.classList.add("js--wrong-input"),d.classList.contains("js--error")||d.classList.add("js--error")),i.checked&&(u.classList.contains("js--wrong-input")&&u.classList.remove("js--wrong-input"),d.classList.contains("js--error")&&d.classList.remove("js--error"))})),n.addEventListener("submit",(function(n){n.preventDefault(),e.classList.remove("js--personal-data"),e.classList.add("js--registration-end"),t[1].classList.add("js--checked"),t[2].classList.add("js--active")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiLCJhY2NvdW50LmpzIiwiY29udGFjdHMuanMiLCJwcm9kdWN0LWRhdGEuanMiLCJwZXJzb25hbC1kYXRhLmpzIl0sIm5hbWVzIjpbIm5hbWVJbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInBhc3N3b3JkSW5wdXQiLCJzdWJtaXRCdXR0b24iLCJvbklucHV0IiwiZXZ0IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJhZGRFdmVudExpc3RlbmVyIiwidmFsdWUiLCJhZGQiLCJvbGRQcm9kdWN0c0J1dHRvbiIsIm9sZFByb2R1Y3RzU2hvdyIsIm9sZFByb2R1Y3RzSGlkZSIsIm9sZFByb2R1Y3RzIiwib2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUiLCJpdGVtIiwidG9nZ2xlIiwicHJvZHVjdFJlZ2lzdHJhdGlvbiIsInJlZ2lzdHJhdGlvbkl0ZW0iLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29udGFjdHNQaG9uZSIsImNvbnRhY3RzQ29kZSIsInBob25lSW5wdXQiLCJjb2RlSW5wdXQiLCJwaG9uZUJ1dHRvbiIsImNvZGVCdXR0b24iLCJwaG9uZUZvcm0iLCJjb2RlRm9ybSIsInByb2R1Y3RDaGFuZ2VCdXR0b24iLCJzZWxlY3RlZFBob25lIiwiY29kZUVycm9yIiwiY29kZUxhYmVsIiwicGhvbmVDaGFuZ2VCdXR0b24iLCJFUlJPUl9NRVNTQUdFUyIsImF0dGVtcHRzIiwiSW5wdXRtYXNrIiwibWFzayIsInBsYWNlaG9sZGVyIiwic2hvdyIsImhpZGUiLCJzdHIiLCJsZW5ndGgiLCJpbmRleE9mIiwicmVtb3ZlQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwicHJldmVudERlZmF1bHQiLCJ0ZXh0Q29udGVudCIsImZvY3VzIiwiYm9keSIsInByb2R1Y3REYXRhRm9ybSIsIndhcnJhbnR5Q29kZUJ1dHRvbiIsInBvcHVwIiwicG9wdXBDbG9zZSIsInBvcHVwT3ZlcmxheSIsImNhbGVuZGFySW5wdXQiLCJjYWxlbmRhckJ1dHRvbiIsInNlcmlhbE51bWJlcklucHV0IiwiZGF0YVN1Ym1pdCIsImNoZWNrVmFsaWRpdHkiLCJ0ZXN0IiwiZ2V0Q29ycmVjdE51bWJlciIsIm51bSIsIk1hdGgiLCJmbG9vciIsInBpY2tlciIsIlBpa2FkYXkiLCJmaWVsZCIsImZpcnN0RGF5Iiwib25TZWxlY3QiLCJkYXRlIiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwib25TZXJpYWxOdW1iZXJJbnB1dCIsImlkIiwibmV4dFNpYmxpbmciLCJjbG9zZVBvcHVwIiwiZm9yRWFjaCIsImVsIiwiY29uc29sZSIsImxvZyIsImZvcm0iLCJzdXJuYW1lSW5wdXQiLCJwYXRyb255bWljSW5wdXQiLCJjaXR5SW5wdXQiLCJlbWFpbElucHV0IiwiY2hlY2tib3giLCJjaGVja2JveExhYmVsIiwiYWdyZWVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImNoZWNrZWQiLCJsYWJlbCIsInBhcmVudE5vZGUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxzQkFDQUMsRUFBQUYsU0FBQUMsY0FBQSwwQkFDQUUsRUFBQUgsU0FBQUMsY0FBQSwwQkFFQSxHQUFBRixHQUFBRyxHQUFBQyxFQUFBLENBSUEsSUFVQUMsRUFBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFDLE9BQ0FBLEVBQUFDLFVBQUFDLFNBQUEsb0JBQ0FGLEVBQUFDLFVBQUFFLE9BQUEsb0JBSUFOLEVBQUFPLGlCQUFBLFNBakJBLFdBQ0EsS0FBQVgsRUFBQVksT0FDQVosRUFBQVEsVUFBQUssSUFBQSxtQkFHQSxLQUFBVixFQUFBUyxPQUNBVCxFQUFBSyxVQUFBSyxJQUFBLHNCQVlBYixFQUFBVyxpQkFBQSxRQUFBTixHQUNBRixFQUFBUSxpQkFBQSxRQUFBTixJQTVCQSxHQ0FBLFdBQ0EsSUFBQVMsRUFBQWIsU0FBQUMsY0FBQSw4QkFDQWEsRUFBQWQs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RixFQUFBbEYsaUJBQUEsUUFBQU4sR0FDQXlGLEVBQUFuRixpQkFBQSxVQXZDQSxXQUNBbUQsSUFFQWdDLEVBQUFLLFVBQ0FKLEVBQUF2RixVQUFBQyxTQUFBLG9CQUNBc0YsRUFBQXZGLFVBQUFLLElBQUEsbUJBR0FtRixFQUFBeEYsVUFBQUMsU0FBQSxjQUNBdUYsRUFBQXhGLFVBQUFLLElBQUEsY0FJQWlGLEVBQUFLLFVBQ0FKLEVBQUF2RixVQUFBQyxTQUFBLG9CQUNBc0YsRUFBQXZGLFVBQUFFLE9BQUEsbUJBR0FzRixFQUFBeEYsVUFBQUMsU0FBQSxjQUNBdUYsRUFBQXhGLFVBQUFFLE9BQUEsaUJBc0JBK0UsRUFBQTlFLGlCQUFBLFVBakJBLFNBQUFMLEdBQ0FBLEVBQUEyQyxpQkFFQTVCLEVBQUFiLFVBQUFFLE9BQUEscUJBQ0FXLEVBQUFiLFVBQUFLLElBQUEsd0JBRUFTLEVBQUEsR0FBQWQsVUFBQUssSUFBQSxlQUNBUyxFQUFBLEdBQUFkLFVBQUFLLElBQUEsa0JBNUZBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICB2YXIgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J25hbWUnXVwiKTtcbiAgdmFyIHBhc3N3b3JkSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcbiAgdmFyIHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRob3JpemF0aW9uX19idXR0b24nKTtcblxuICBpZiAoIW5hbWVJbnB1dCB8fCAhcGFzc3dvcmRJbnB1dCB8fCAhc3VibWl0QnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG9uU3VibWl0QnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKG5hbWVJbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIG5hbWVJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG5cbiAgICBpZiAocGFzc3dvcmRJbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIHBhc3N3b3JkSW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uSW5wdXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdmFyIHRhcmdldCA9IGV2dC50YXJnZXQ7XG4gICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuICB9XG5cbiAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TdWJtaXRCdXR0b25DbGljayk7XG4gIG5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBwYXNzd29yZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIG9sZFByb2R1Y3RzQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19idXR0b24nKTtcbiAgdmFyIG9sZFByb2R1Y3RzU2hvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3QtdXNlZC1wcm9kdWN0c19fc2hvdycpO1xuICB2YXIgb2xkUHJvZHVjdHNIaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19oaWRlJyk7XG4gIHZhciBvbGRQcm9kdWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3QtdXNlZC1wcm9kdWN0c19fY29udGVudCcpO1xuXG4gIGlmICghb2xkUHJvZHVjdHNCdXR0b24pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnc2hvd24nKTtcbiAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICB9O1xuXG4gIHZhciBvbk9sZFByb2R1Y3RzQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUob2xkUHJvZHVjdHNTaG93KTtcbiAgICBvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZShvbGRQcm9kdWN0c0hpZGUpO1xuICAgIG9sZFByb2R1Y3RzLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTtcbiAgfTtcblxuICBvbGRQcm9kdWN0c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT2xkUHJvZHVjdHNCdXR0b25DbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHByb2R1Y3RSZWdpc3RyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1yZWdpc3RyYXRpb24nKTtcbiAgdmFyIHJlZ2lzdHJhdGlvbkl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdC1yZWdpc3RyYXRpb25fX25hdmlnYXRpb24taXRlbScpO1xuXG4gIHZhciBjb250YWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0cycpO1xuICB2YXIgY29udGFjdHNQaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtbnVtYmVyJyk7XG4gIHZhciBjb250YWN0c0NvZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUnKTtcbiAgdmFyIHBob25lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGhvbmUtbnVtYmVyJ11cIik7XG4gIHZhciBjb2RlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGhvbmUtY29kZSddXCIpXG4gIHZhciBwaG9uZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtZm9ybSBidXR0b24nKTtcbiAgdmFyIGNvZGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybSBidXR0b24nKVxuICB2YXIgcGhvbmVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19waG9uZS1mb3JtJyk7XG4gIHZhciBjb2RlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1mb3JtJyk7XG4gIHZhciBwcm9kdWN0Q2hhbmdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19wcm9kdWN0LWNhcmQgLnByb2R1Y3QtY2FyZF9fY2hhbmdlJyk7XG4gIHZhciBzZWxlY3RlZFBob25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19zZWxlY3RlZC1waG9uZScpO1xuICB2YXIgY29kZUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlLWVycm9yLW1lc3NhZ2UnKTtcbiAgdmFyIGNvZGVMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1mb3JtIGxhYmVsJyk7XG4gIHZhciBwaG9uZUNoYW5nZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fc2VsZWN0ZWQtcGhvbmUtY2hhbmdlJyk7XG5cbiAgdmFyIENPUlJFQ1RfQ09ERSA9ICcwMDAwMDAwJztcbiAgdmFyIEVSUk9SX01FU1NBR0VTID0ge1xuICAgIGZpcnN0OiAn0KPQutCw0LfQsNC9INC90LXQstC10YDQvdGL0Lkg0LrQvtC0LCDQvtGB0YLQsNC70L7RgdGMINC/0L7Qv9GL0YLQvtC6OiAxJyxcbiAgICBzZWNvbmQ6ICfQktGLINC/0YDQtdCy0YvRgdC40LvQuCDQutC+0LvQuNGH0LXRgdGC0LLQviDQv9C+0L/Ri9GC0L7Quiwg0YHQu9C10LTRg9GO0YnQuNC5INC30LDQv9GA0L7RgSDQutC+0LTQsCDQstC+0LfQvNC+0LbQtdC9INGH0LXRgNC10LcgMTAg0LzQuNC90YPRgidcbiAgfTtcblxuICB2YXIgYXR0ZW1wdHMgPSAwO1xuXG4gIGlmICghcGhvbmVJbnB1dCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpbVBob25lID0gbmV3IElucHV0bWFzaygnKzcoOTk5KTk5OS05OS05OScpO1xuICBpbVBob25lLm1hc2socGhvbmVJbnB1dCk7XG5cbiAgdmFyIGltQ29kZSA9IG5ldyBJbnB1dG1hc2soJzk5OTk5OTknLCB7IHBsYWNlaG9sZGVyOiAnJyB9KTtcbiAgaW1Db2RlLm1hc2soY29kZUlucHV0KTtcblxuICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGhpZGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGRlbicpKSB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgY2xlYXJFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSAnJztcblxuICAgIGlmIChjb2RlTGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgY29kZUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1lcnJvcicpO1xuICAgIH1cblxuICAgIGlmIChjb2RlSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgY29kZUlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25QaG9uZUlucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzdHIgPSBwaG9uZUlucHV0LnZhbHVlO1xuICAgIGlmIChzdHIubGVuZ3RoID09PSAxNiAmJiBzdHIuaW5kZXhPZignXycpID09PSAtMSkge1xuICAgICAgcGhvbmVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwaG9uZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25Qcm9kdWN0Q2hhbmdlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcbiAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1wcm9kdWN0LWRhdGEnKTtcblxuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMF0uY2xhc3NMaXN0LnJlbW92ZSgnanMtLWNoZWNrZWQnKTtcbiAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1hY3RpdmUnKTtcblxuICAgIHNob3coY29udGFjdHNQaG9uZSk7XG4gICAgaGlkZShjb250YWN0c0NvZGUpO1xuICB9O1xuXG4gIHZhciBvblBob25lU3VibWl0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHNlbGVjdGVkUGhvbmUudGV4dENvbnRlbnQgPSBwaG9uZUlucHV0LnZhbHVlO1xuICAgIGhpZGUoY29udGFjdHNQaG9uZSk7XG4gICAgc2hvdyhjb250YWN0c0NvZGUpO1xuXG4gICAgY29kZUlucHV0LmZvY3VzKCk7XG4gIH07XG5cbiAgdmFyIG9uUGhvbmVDaGFuZ2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBoaWRlKGNvbnRhY3RzQ29kZSk7XG4gICAgc2hvdyhjb250YWN0c1Bob25lKTtcblxuICAgIHBob25lSW5wdXQuZm9jdXMoKTtcbiAgfVxuXG4gIHZhciBvbkNvZGVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbGVhckVycm9yKCk7XG4gICAgaWYgKGNvZGVJbnB1dC52YWx1ZS5sZW5ndGggPT09IDcpIHtcbiAgICAgIGNvZGVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2RlQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uQ29kZVN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoY29kZUlucHV0LnZhbHVlICE9PSBDT1JSRUNUX0NPREUpIHtcbiAgICAgIGlmICghY29kZUxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgY29kZUxhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWNvZGVJbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGNvZGVJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGF0dGVtcHRzID09PSAwKSB7XG4gICAgICAgIGNvZGVFcnJvci50ZXh0Q29udGVudCA9IEVSUk9SX01FU1NBR0VTLmZpcnN0O1xuICAgICAgfVxuXG4gICAgICBpZiAoYXR0ZW1wdHMgPiAwKSB7XG4gICAgICAgIGNvZGVFcnJvci50ZXh0Q29udGVudCA9IEVSUk9SX01FU1NBR0VTLnNlY29uZDtcbiAgICAgICAgY29kZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgICAgfVxuXG4gICAgICBhdHRlbXB0cysrO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1wZXJzb25hbC1kYXRhJyk7XG4gICAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1jb250YWN0cycpO1xuICAgIH1cbiAgfTtcblxuICBwaG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25QaG9uZUlucHV0KTtcbiAgcHJvZHVjdENoYW5nZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUHJvZHVjdENoYW5nZUNsaWNrKTtcbiAgcGhvbmVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIG9uUGhvbmVTdWJtaXQpO1xuICBjb2RlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkNvZGVJbnB1dCk7XG4gIGNvZGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIG9uQ29kZVN1Ym1pdCk7XG4gIHBob25lQ2hhbmdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25QaG9uZUNoYW5nZUNsaWNrKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICB2YXIgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgdmFyIHBob25lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGhvbmUtbnVtYmVyJ11cIik7XG5cbiAgdmFyIHByb2R1Y3RSZWdpc3RyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1yZWdpc3RyYXRpb24nKTtcbiAgdmFyIHJlZ2lzdHJhdGlvbkl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdC1yZWdpc3RyYXRpb25fX25hdmlnYXRpb24taXRlbScpO1xuXG4gIHZhciBwcm9kdWN0RGF0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGEnKTtcbiAgdmFyIHByb2R1Y3REYXRhRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGEgZm9ybScpO1xuICB2YXIgd2FycmFudHlDb2RlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj0nc2VyaWFsLW51bWJlci0xJ10gYnV0dG9uXCIpO1xuICB2YXIgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHknKTtcbiAgdmFyIHBvcHVwQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHlfX2Nsb3NlJyk7XG4gIHZhciBwb3B1cE92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHlfX292ZXJsYXknKTtcblxuICB2YXIgY2FsZW5kYXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9kdWN0LWRhdGFfX3B1cmNoYXNlLWRhdGUnKTtcbiAgdmFyIGNhbGVuZGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtZGF0YV9fY2FsZW5kYXInKTtcblxuICB2YXIgc2VyaWFsTnVtYmVySW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdC1kYXRhX19zZXJpYWwtbnVtYmVyJyk7XG4gIHZhciBkYXRhU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2R1Y3QtZGF0YV9fc3VibWl0Jyk7XG5cbiAgaWYoIXdhcnJhbnR5Q29kZUJ1dHRvbikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjaGVja1ZhbGlkaXR5ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmKFxuICAgICAgc2VyaWFsTnVtYmVySW5wdXRbMF0udmFsdWUubGVuZ3RoID09PSA2XG4gICAgICAmJiBzZXJpYWxOdW1iZXJJbnB1dFsxXS52YWx1ZS5sZW5ndGggPT09IDZcbiAgICAgICYmIHNlcmlhbE51bWJlcklucHV0WzJdLnZhbHVlLmxlbmd0aCA9PT0gNlxuICAgICAgJiYgKC9eWzAtOS5dKyQvKS50ZXN0KGNhbGVuZGFySW5wdXQudmFsdWUpXG4gICAgKSB7XG4gICAgICBkYXRhU3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YVN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgZ2V0Q29ycmVjdE51bWJlciA9IGZ1bmN0aW9uIChudW0pIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihudW0gLyAxMCkgPiAwID8gbnVtIDogJzAnICsgbnVtO1xuICB9O1xuXG4gIHZhciBnZXREYXRlID0gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuXG4gICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7XG4gICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICByZXR1cm4gZ2V0Q29ycmVjdE51bWJlcihkYXkpICsgJy4nICsgZ2V0Q29ycmVjdE51bWJlcihtb250aCkgKyAnLicgKyB5ZWFyO1xuICB9O1xuXG4gIHZhciBwaWNrZXIgPSBuZXcgUGlrYWRheSh7XG4gICAgZmllbGQ6IGNhbGVuZGFyQnV0dG9uLFxuICAgIGZpcnN0RGF5OiAxLFxuICAgIG9uU2VsZWN0OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBkYXRlID0gbmV3IERhdGUocGlja2VyKTtcbiAgICAgIGNhbGVuZGFySW5wdXQudmFsdWUgPSBnZXREYXRlKGRhdGUpO1xuICAgICAgY2hlY2tWYWxpZGl0eSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGltID0gbmV3IElucHV0bWFzaygnOTkuOTkuOTk5OScsIHsgJ3BsYWNlaG9sZGVyJzogJ9CU0JQu0JzQnC7Qk9CT0JPQkyd9KTtcbiAgaW0ubWFzayhjYWxlbmRhcklucHV0KTtcblxuICB2YXIgb25TZXJpYWxOdW1iZXJJbnB1dCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcblxuICAgIGlmICh0YXJnZXQudmFsdWUubGVuZ3RoID09PSA2KSB7XG4gICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnanMtLXdyb25nLWlucHV0JykpIHtcbiAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGFyZ2V0LmlkID09PSAnc2VyaWFsLW51bWJlci0xJyB8fCB0YXJnZXQuaWQgPT09ICdzZXJpYWwtbnVtYmVyLTInKSB7XG4gICAgICAgIHRhcmdldC5uZXh0U2libGluZy5uZXh0U2libGluZy5mb2N1cygpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGFyZ2V0LmlkID09PSAnc2VyaWFsLW51bWJlci0zJykge1xuICAgICAgICBjYWxlbmRhcklucHV0LmZvY3VzKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG5cbiAgICBjaGVja1ZhbGlkaXR5KCk7XG4gIH07XG5cbiAgdmFyIG9uQ2FsZW5kYXJJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjaGVja1ZhbGlkaXR5KCk7XG4gICAgY29uc29sZS5sb2coY2FsZW5kYXJJbnB1dC52YWx1ZS5sZW5ndGgpO1xuXG4gIH07XG5cbiAgdmFyIG9wZW5Qb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ3BvcHVwJyk7XG4gIH07XG5cbiAgdmFyIGNsb3NlUG9wdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgcG9wdXAuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cCcpO1xuICB9XG5cbiAgdmFyIG9uV2FycmFudHlDb2RlQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgb3BlblBvcHVwKCk7XG4gIH07XG5cbiAgdmFyIG9uUG9wdXBDbG9zZUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGNsb3NlUG9wdXAoKTtcbiAgfTtcblxuICB2YXIgb25Qb3B1cE92ZXJsYXlDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbG9zZVBvcHVwKCk7XG4gIH07XG5cbiAgdmFyIG9uU3VibWl0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHByb2R1Y3RSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLWNvbnRhY3RzJyk7XG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tcHJvZHVjdC1kYXRhJyk7XG5cbiAgICByZWdpc3RyYXRpb25JdGVtWzBdLmNsYXNzTGlzdC5hZGQoJ2pzLS1jaGVja2VkJyk7XG4gICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QuYWRkKCdqcy0tYWN0aXZlJyk7XG5cbiAgICBwaG9uZUlucHV0LmZvY3VzKCk7XG4gIH07XG5cbiAgd2FycmFudHlDb2RlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25XYXJyYW50eUNvZGVCdXR0b25DbGljayk7XG4gIHBvcHVwQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblBvcHVwQ2xvc2VDbGljayk7XG4gIHBvcHVwT3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUG9wdXBPdmVybGF5Q2xpY2spO1xuXG4gIHNlcmlhbE51bWJlcklucHV0LmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvblNlcmlhbE51bWJlcklucHV0KTtcbiAgfSk7XG5cbiAgY2FsZW5kYXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uQ2FsZW5kYXJJbnB1dCk7XG4gIHByb2R1Y3REYXRhRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvblN1Ym1pdCk7XG59KCkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHByb2R1Y3RSZWdpc3RyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZHVjdC1yZWdpc3RyYXRpb24nKTtcbiAgdmFyIHJlZ2lzdHJhdGlvbkl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJvZHVjdC1yZWdpc3RyYXRpb25fX25hdmlnYXRpb24taXRlbScpO1xuXG4gIHZhciBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBlcnNvbmFsLWRhdGFfX2Zvcm0nKTtcbiAgdmFyIHN1cm5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdzdXJuYW1lJ11cIik7XG4gIHZhciBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nbmFtZSddXCIpO1xuICB2YXIgcGF0cm9ueW1pY0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J3BhdHJvbnltaWMnXVwiKTtcbiAgdmFyIGNpdHlJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdjaXR5J11cIik7XG4gIHZhciBlbWFpbElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J2VtYWlsJ11cIik7XG4gIHZhciBjaGVja2JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFt0eXBlPSdjaGVja2JveCddXCIpO1xuICB2YXIgY2hlY2tib3hMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZXJzb25hbC1kYXRhX19hZ3JlZW1lbnQtd3JhcHBlciBsYWJlbCcpO1xuICB2YXIgYWdyZWVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhX190ZXh0LXdyYXBwZXJcIik7XG4gIHZhciBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyc29uYWwtZGF0YV9fYnV0dG9uJyk7XG5cbiAgaWYgKCFzdXJuYW1lSW5wdXQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hlY2tWYWxpZGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoXG4gICAgICBzdXJuYW1lSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIG5hbWVJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgcGF0cm9ueW1pY0lucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBjaXR5SW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGVtYWlsSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGNoZWNrYm94LmNoZWNrZWRcbiAgICApIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25JbnB1dCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBjaGVja1ZhbGlkaXR5KCk7XG5cbiAgICB2YXIgaXRlbSA9IGV2dC50YXJnZXQ7XG4gICAgdmFyIGxhYmVsID0gaXRlbS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ3AnKTtcblxuICAgIGlmICghaXRlbS52YWxpZGl0eS52YWxpZCkge1xuICAgICAgaWYgKCFsYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpdGVtLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICBpZiAobGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgICBsYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBvbkNoZWNrYm94Q2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuXG4gICAgaWYgKCFjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICBpZiAoIWNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjaGVja2JveExhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWFncmVlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGFncmVlbWVudC5jbGFzc0xpc3QuYWRkKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgaWYgKGNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjaGVja2JveExhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWdyZWVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgYWdyZWVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBvbkZvcm1TdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBwcm9kdWN0UmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1wZXJzb25hbC1kYXRhJyk7XG4gICAgcHJvZHVjdFJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QuYWRkKCdqcy0tcmVnaXN0cmF0aW9uLWVuZCcpO1xuXG4gICAgcmVnaXN0cmF0aW9uSXRlbVsxXS5jbGFzc0xpc3QuYWRkKCdqcy0tY2hlY2tlZCcpO1xuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMl0uY2xhc3NMaXN0LmFkZCgnanMtLWFjdGl2ZScpO1xuICB9O1xuXG4gIHN1cm5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBuYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgcGF0cm9ueW1pY0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIGNpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBlbWFpbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDbGljayk7XG5cbiAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbkZvcm1TdWJtaXQpO1xufSkoKTtcbiJdfQ==
