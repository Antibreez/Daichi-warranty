!function(){var e=document.querySelector("input[name='name']"),t=document.querySelector("input[name='password']"),n=document.querySelector(".authorization__button");if(e&&t&&n){var s=function(e){var t=e.target;t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input")};n.addEventListener("click",(function(){""===e.value&&e.classList.add("js--wrong-input"),""===t.value&&t.classList.add("js--wrong-input")})),e.addEventListener("input",s),t.addEventListener("input",s)}}(),function(){var e=document.querySelector(".not-used-products__button"),t=document.querySelector(".not-used-products__show"),n=document.querySelector(".not-used-products__hide"),s=document.querySelector(".not-used-products__content");if(e){var a=function(e){e.classList.toggle("shown"),e.classList.toggle("hidden")};e.addEventListener("click",(function(){a(t),a(n),s.classList.toggle("show")}))}}(),function(){var e=document.querySelector(".device-registration"),t=document.querySelectorAll(".device-registration__navigation-item"),n=(document.querySelector(".contacts"),document.querySelector(".contacts__phone-number")),s=document.querySelector(".contacts__code"),a=document.querySelector("input[name='phone-number']"),r=document.querySelector("input[name='phone-code']"),o=document.querySelector(".contacts__phone-form button"),c=document.querySelector(".contacts__code-form button"),i=document.querySelector(".contacts__phone-form"),d=document.querySelector(".contacts__code-form"),u=document.querySelector(".contacts__product-card .product-card__change"),l=document.querySelector(".contacts__selected-phone"),m=document.querySelector(".contacts__code-error-message"),v=document.querySelector(".contacts__code-form label"),p=document.querySelector(".contacts__selected-phone-change"),L="Указан неверный код, осталось попыток: 1",y="Вы превысили количество попыток, следующий запрос кода возможен через 10 минут",_=0;if(a){new Inputmask("+7(999)999-99-99").mask(a),new Inputmask("9999999",{placeholder:""}).mask(r);var f=function(e){e.classList.contains("hidden")&&e.classList.remove("hidden")},g=function(e){e.classList.contains("hidden")||e.classList.add("hidden")};a.addEventListener("input",(function(){var e=a.value;16===e.length&&-1===e.indexOf("_")?o.removeAttribute("disabled"):o.setAttribute("disabled","")})),u.addEventListener("click",(function(){e.classList.remove("js--contacts"),e.classList.add("js--device-data"),t[0].classList.remove("js--checked"),t[1].classList.remove("js--active"),f(n),g(s)})),i.addEventListener("submit",(function(e){e.preventDefault(),l.textContent=a.value,g(n),f(s),r.focus()})),r.addEventListener("input",(function(){m.textContent="",v.classList.contains("js--error")&&v.classList.remove("js--error"),r.classList.contains("js--wrong-input")&&r.classList.remove("js--wrong-input"),7===r.value.length?c.removeAttribute("disabled"):c.setAttribute("disabled","")})),d.addEventListener("submit",(function(t){t.preventDefault(),"0000000"!==r.value?(v.classList.contains("js--error")||v.classList.add("js--error"),r.classList.contains("js--wrong-input")||r.classList.add("js--wrong-input"),0===_&&(m.textContent=L),_>0&&(m.textContent=y,c.setAttribute("disabled","")),_++):(e.classList.add("js--personal-data"),e.classList.remove("js--contacts"))})),p.addEventListener("click",(function(){g(s),f(n),a.focus()}))}}(),function(){var e=document.querySelector("body"),t=document.querySelector("input[name='phone-number']"),n=document.querySelector(".device-registration"),s=document.querySelectorAll(".device-registration__navigation-item"),a=(document.querySelector(".device-data"),document.querySelector(".device-data form")),r=document.querySelector("label[for='serial-number-1'] button"),o=document.querySelector(".popup-warranty"),c=document.querySelector(".popup-warranty__close"),i=document.querySelector(".popup-warranty__overlay"),d=document.querySelector(".device-data__purchase-date"),u=document.querySelector(".device-data__calendar"),l=document.querySelectorAll(".device-data__serial-number"),m=document.querySelector(".device-data__submit");if(r){var v=function(){6===l[0].value.length&&6===l[1].value.length&&6===l[2].value.length&&/^[0-9.]+$/.test(d.value)?m.removeAttribute("disabled"):m.setAttribute("disabled","")},p=function(e){return Math.floor(e/10)>0?e:"0"+e},L=new Pikaday({field:u,firstDay:1,onSelect:function(){var e=new Date(L);d.value=function(e){var t=(e=new Date(e)).getDate(),n=e.getMonth()+1,s=e.getFullYear();return p(t)+"."+p(n)+"."+s}(e),v()}});new Inputmask("99.99.9999",{placeholder:"ДД.ММ.ГГГГ"}).mask(d);var y=function(e){var t=e.target;6===t.value.length?(t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"),"serial-number-1"!==t.id&&"serial-number-2"!==t.id||t.nextSibling.nextSibling.focus(),"serial-number-3"===t.id&&d.focus()):t.classList.add("js--wrong-input"),v()},_=function(){o.classList.add("hidden"),e.classList.remove("popup")};r.addEventListener("click",(function(){o.classList.remove("hidden"),e.classList.add("popup")})),c.addEventListener("click",(function(){_()})),i.addEventListener("click",(function(){_()})),l.forEach((function(e){e.addEventListener("input",y)})),d.addEventListener("input",(function(){v(),console.log(d.value.length)})),a.addEventListener("submit",(function(e){e.preventDefault(),n.classList.add("js--contacts"),n.classList.remove("js--device-data"),s[0].classList.add("js--checked"),s[1].classList.add("js--active"),t.focus()}))}}(),function(){var e=document.querySelector(".device-registration"),t=document.querySelectorAll(".device-registration__navigation-item"),n=document.querySelector(".personal-data__form"),s=document.querySelector(".personal-data input[name='surname']"),a=document.querySelector(".personal-data input[name='name']"),r=document.querySelector(".personal-data input[name='patronymic']"),o=document.querySelector(".personal-data input[name='city']"),c=document.querySelector(".personal-data input[name='email']"),i=document.querySelector(".personal-data input[type='checkbox']"),d=document.querySelector(".personal-data__agreement-wrapper label"),u=document.querySelector(".personal-data__text-wrapper"),l=document.querySelector(".personal-data__button");if(s){var m=function(){s.validity.valid&&a.validity.valid&&r.validity.valid&&o.validity.valid&&c.validity.valid&&i.checked?l.removeAttribute("disabled"):l.setAttribute("disabled","")},v=function(e){m();var t=e.target,n=t.parentNode.querySelector("p");t.validity.valid||(n.classList.contains("js--error")||n.classList.add("js--error"),t.classList.contains("js--wrong-input")||t.classList.add("js--wrong-input")),t.validity.valid&&(n.classList.contains("js--error")&&n.classList.remove("js--error"),t.classList.contains("js--wrong-input")&&t.classList.remove("js--wrong-input"))};s.addEventListener("input",v),a.addEventListener("input",v),r.addEventListener("input",v),o.addEventListener("input",v),c.addEventListener("input",v),i.addEventListener("change",(function(){m(),i.checked||(d.classList.contains("js--wrong-input")||d.classList.add("js--wrong-input"),u.classList.contains("js--error")||u.classList.add("js--error")),i.checked&&(d.classList.contains("js--wrong-input")&&d.classList.remove("js--wrong-input"),u.classList.contains("js--error")&&u.classList.remove("js--error"))})),n.addEventListener("submit",(function(n){n.preventDefault(),e.classList.remove("js--personal-data"),e.classList.add("js--registration-end"),t[1].classList.add("js--checked"),t[2].classList.add("js--active")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiLCJhY2NvdW50LmpzIiwiY29udGFjdHMuanMiLCJkZXZpY2UtZGF0YS5qcyIsInBlcnNvbmFsLWRhdGEuanMiXSwibmFtZXMiOlsibmFtZUlucHV0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicGFzc3dvcmRJbnB1dCIsInN1Ym1pdEJ1dHRvbiIsIm9uSW5wdXQiLCJldnQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2YWx1ZSIsImFkZCIsIm9sZFByb2R1Y3RzQnV0dG9uIiwib2xkUHJvZHVjdHNTaG93Iiwib2xkUHJvZHVjdHNIaWRlIiwib2xkUHJvZHVjdHMiLCJvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZSIsIml0ZW0iLCJ0b2dnbGUiLCJkZXZpY2VSZWdpc3RyYXRpb24iLCJyZWdpc3RyYXRpb25JdGVtIiwicXVlcnlTZWxlY3RvckFsbCIsImNvbnRhY3RzUGhvbmUiLCJjb250YWN0c0NvZGUiLCJwaG9uZUlucHV0IiwiY29kZUlucHV0IiwicGhvbmVCdXR0b24iLCJjb2RlQnV0dG9uIiwicGhvbmVGb3JtIiwiY29kZUZvcm0iLCJwcm9kdWN0Q2hhbmdlQnV0dG9uIiwic2VsZWN0ZWRQaG9uZSIsImNvZGVFcnJvciIsImNvZGVMYWJlbCIsInBob25lQ2hhbmdlQnV0dG9uIiwiRVJST1JfTUVTU0FHRVMiLCJhdHRlbXB0cyIsIklucHV0bWFzayIsIm1hc2siLCJwbGFjZWhvbGRlciIsInNob3ciLCJoaWRlIiwic3RyIiwibGVuZ3RoIiwiaW5kZXhPZiIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInByZXZlbnREZWZhdWx0IiwidGV4dENvbnRlbnQiLCJmb2N1cyIsImJvZHkiLCJkZXZpY2VEYXRhRm9ybSIsIndhcnJhbnR5Q29kZUJ1dHRvbiIsInBvcHVwIiwicG9wdXBDbG9zZSIsInBvcHVwT3ZlcmxheSIsImNhbGVuZGFySW5wdXQiLCJjYWxlbmRhckJ1dHRvbiIsInNlcmlhbE51bWJlcklucHV0IiwiZGF0YVN1Ym1pdCIsImNoZWNrVmFsaWRpdHkiLCJ0ZXN0IiwiZ2V0Q29ycmVjdE51bWJlciIsIm51bSIsIk1hdGgiLCJmbG9vciIsInBpY2tlciIsIlBpa2FkYXkiLCJmaWVsZCIsImZpcnN0RGF5Iiwib25TZWxlY3QiLCJkYXRlIiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwib25TZXJpYWxOdW1iZXJJbnB1dCIsImlkIiwibmV4dFNpYmxpbmciLCJjbG9zZVBvcHVwIiwiZm9yRWFjaCIsImVsIiwiY29uc29sZSIsImxvZyIsImZvcm0iLCJzdXJuYW1lSW5wdXQiLCJwYXRyb255bWljSW5wdXQiLCJjaXR5SW5wdXQiLCJlbWFpbElucHV0IiwiY2hlY2tib3giLCJjaGVja2JveExhYmVsIiwiYWdyZWVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsImNoZWNrZWQiLCJsYWJlbCIsInBhcmVudE5vZGUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxzQkFDQUMsRUFBQUYsU0FBQUMsY0FBQSwwQkFDQUUsRUFBQUgsU0FBQUMsY0FBQSwwQkFFQSxHQUFBRixHQUFBRyxHQUFBQyxFQUFBLENBSUEsSUFVQUMsRUFBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFDLE9BQ0FBLEVBQUFDLFVBQUFDLFNBQUEsb0JBQ0FGLEVBQUFDLFVBQUFFLE9BQUEsb0JBSUFOLEVBQUFPLGlCQUFBLFNBakJBLFdBQ0EsS0FBQVgsRUFBQVksT0FDQVosRUFBQVEsVUFBQUssSUFBQSxtQkFHQSxLQUFBVixFQUFBUyxPQUNBVCxFQUFBSyxVQUFBSyxJQUFBLHNCQVlBYixFQUFBVyxpQkFBQSxRQUFBTixHQUNBRixFQUFBUSxpQkFBQSxRQUFBTixJQTVCQSxHQ0FBLFdBQ0EsSUFBQVMsRUFBQWIsU0FBQUMsY0FBQSw4QkFDQWEsRUFBQWQsU0FB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QUFBbEYsaUJBQUEsUUFBQU4sR0FDQXlGLEVBQUFuRixpQkFBQSxVQXZDQSxXQUNBbUQsSUFFQWdDLEVBQUFLLFVBQ0FKLEVBQUF2RixVQUFBQyxTQUFBLG9CQUNBc0YsRUFBQXZGLFVBQUFLLElBQUEsbUJBR0FtRixFQUFBeEYsVUFBQUMsU0FBQSxjQUNBdUYsRUFBQXhGLFVBQUFLLElBQUEsY0FJQWlGLEVBQUFLLFVBQ0FKLEVBQUF2RixVQUFBQyxTQUFBLG9CQUNBc0YsRUFBQXZGLFVBQUFFLE9BQUEsbUJBR0FzRixFQUFBeEYsVUFBQUMsU0FBQSxjQUNBdUYsRUFBQXhGLFVBQUFFLE9BQUEsaUJBc0JBK0UsRUFBQTlFLGlCQUFBLFVBakJBLFNBQUFMLEdBQ0FBLEVBQUEyQyxpQkFFQTVCLEVBQUFiLFVBQUFFLE9BQUEscUJBQ0FXLEVBQUFiLFVBQUFLLElBQUEsd0JBRUFTLEVBQUEsR0FBQWQsVUFBQUssSUFBQSxlQUNBUyxFQUFBLEdBQUFkLFVBQUFLLElBQUEsa0JBNUZBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICB2YXIgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J25hbWUnXVwiKTtcbiAgdmFyIHBhc3N3b3JkSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcbiAgdmFyIHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRob3JpemF0aW9uX19idXR0b24nKTtcblxuICBpZiAoIW5hbWVJbnB1dCB8fCAhcGFzc3dvcmRJbnB1dCB8fCAhc3VibWl0QnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG9uU3VibWl0QnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKG5hbWVJbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIG5hbWVJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICB9XG5cbiAgICBpZiAocGFzc3dvcmRJbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgIHBhc3N3b3JkSW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uSW5wdXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgdmFyIHRhcmdldCA9IGV2dC50YXJnZXQ7XG4gICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgfVxuICB9XG5cbiAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25TdWJtaXRCdXR0b25DbGljayk7XG4gIG5hbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBwYXNzd29yZElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIG9sZFByb2R1Y3RzQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19idXR0b24nKTtcbiAgdmFyIG9sZFByb2R1Y3RzU2hvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3QtdXNlZC1wcm9kdWN0c19fc2hvdycpO1xuICB2YXIgb2xkUHJvZHVjdHNIaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5vdC11c2VkLXByb2R1Y3RzX19oaWRlJyk7XG4gIHZhciBvbGRQcm9kdWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3QtdXNlZC1wcm9kdWN0c19fY29udGVudCcpO1xuXG4gIGlmICghb2xkUHJvZHVjdHNCdXR0b24pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnc2hvd24nKTtcbiAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICB9O1xuXG4gIHZhciBvbk9sZFByb2R1Y3RzQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgb2xkUHJvZHVjdHNCdXR0b25Ub2dnbGUob2xkUHJvZHVjdHNTaG93KTtcbiAgICBvbGRQcm9kdWN0c0J1dHRvblRvZ2dsZShvbGRQcm9kdWN0c0hpZGUpO1xuICAgIG9sZFByb2R1Y3RzLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTtcbiAgfTtcblxuICBvbGRQcm9kdWN0c0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT2xkUHJvZHVjdHNCdXR0b25DbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGRldmljZVJlZ2lzdHJhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXZpY2UtcmVnaXN0cmF0aW9uJyk7XG4gIHZhciByZWdpc3RyYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZS1yZWdpc3RyYXRpb25fX25hdmlnYXRpb24taXRlbScpO1xuXG4gIHZhciBjb250YWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0cycpO1xuICB2YXIgY29udGFjdHNQaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtbnVtYmVyJyk7XG4gIHZhciBjb250YWN0c0NvZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUnKTtcbiAgdmFyIHBob25lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGhvbmUtbnVtYmVyJ11cIik7XG4gIHZhciBjb2RlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaW5wdXRbbmFtZT0ncGhvbmUtY29kZSddXCIpXG4gIHZhciBwaG9uZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fcGhvbmUtZm9ybSBidXR0b24nKTtcbiAgdmFyIGNvZGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGFjdHNfX2NvZGUtZm9ybSBidXR0b24nKVxuICB2YXIgcGhvbmVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19waG9uZS1mb3JtJyk7XG4gIHZhciBjb2RlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1mb3JtJyk7XG4gIHZhciBwcm9kdWN0Q2hhbmdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19wcm9kdWN0LWNhcmQgLnByb2R1Y3QtY2FyZF9fY2hhbmdlJyk7XG4gIHZhciBzZWxlY3RlZFBob25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19zZWxlY3RlZC1waG9uZScpO1xuICB2YXIgY29kZUVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRhY3RzX19jb2RlLWVycm9yLW1lc3NhZ2UnKTtcbiAgdmFyIGNvZGVMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fY29kZS1mb3JtIGxhYmVsJyk7XG4gIHZhciBwaG9uZUNoYW5nZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWN0c19fc2VsZWN0ZWQtcGhvbmUtY2hhbmdlJyk7XG5cbiAgdmFyIENPUlJFQ1RfQ09ERSA9ICcwMDAwMDAwJztcbiAgdmFyIEVSUk9SX01FU1NBR0VTID0ge1xuICAgIGZpcnN0OiAn0KPQutCw0LfQsNC9INC90LXQstC10YDQvdGL0Lkg0LrQvtC0LCDQvtGB0YLQsNC70L7RgdGMINC/0L7Qv9GL0YLQvtC6OiAxJyxcbiAgICBzZWNvbmQ6ICfQktGLINC/0YDQtdCy0YvRgdC40LvQuCDQutC+0LvQuNGH0LXRgdGC0LLQviDQv9C+0L/Ri9GC0L7Quiwg0YHQu9C10LTRg9GO0YnQuNC5INC30LDQv9GA0L7RgSDQutC+0LTQsCDQstC+0LfQvNC+0LbQtdC9INGH0LXRgNC10LcgMTAg0LzQuNC90YPRgidcbiAgfTtcblxuICB2YXIgYXR0ZW1wdHMgPSAwO1xuXG4gIGlmICghcGhvbmVJbnB1dCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpbVBob25lID0gbmV3IElucHV0bWFzaygnKzcoOTk5KTk5OS05OS05OScpO1xuICBpbVBob25lLm1hc2socGhvbmVJbnB1dCk7XG5cbiAgdmFyIGltQ29kZSA9IG5ldyBJbnB1dG1hc2soJzk5OTk5OTknLCB7IHBsYWNlaG9sZGVyOiAnJyB9KTtcbiAgaW1Db2RlLm1hc2soY29kZUlucHV0KTtcblxuICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xuICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGhpZGUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGRlbicpKSB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgY2xlYXJFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb2RlRXJyb3IudGV4dENvbnRlbnQgPSAnJztcblxuICAgIGlmIChjb2RlTGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgY29kZUxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1lcnJvcicpO1xuICAgIH1cblxuICAgIGlmIChjb2RlSW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgY29kZUlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25QaG9uZUlucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzdHIgPSBwaG9uZUlucHV0LnZhbHVlO1xuICAgIGlmIChzdHIubGVuZ3RoID09PSAxNiAmJiBzdHIuaW5kZXhPZignXycpID09PSAtMSkge1xuICAgICAgcGhvbmVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwaG9uZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25Qcm9kdWN0Q2hhbmdlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgZGV2aWNlUmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1jb250YWN0cycpO1xuICAgIGRldmljZVJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QuYWRkKCdqcy0tZGV2aWNlLWRhdGEnKTtcblxuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMF0uY2xhc3NMaXN0LnJlbW92ZSgnanMtLWNoZWNrZWQnKTtcbiAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1hY3RpdmUnKTtcblxuICAgIHNob3coY29udGFjdHNQaG9uZSk7XG4gICAgaGlkZShjb250YWN0c0NvZGUpO1xuICB9O1xuXG4gIHZhciBvblBob25lU3VibWl0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHNlbGVjdGVkUGhvbmUudGV4dENvbnRlbnQgPSBwaG9uZUlucHV0LnZhbHVlO1xuICAgIGhpZGUoY29udGFjdHNQaG9uZSk7XG4gICAgc2hvdyhjb250YWN0c0NvZGUpO1xuXG4gICAgY29kZUlucHV0LmZvY3VzKCk7XG4gIH07XG5cbiAgdmFyIG9uUGhvbmVDaGFuZ2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBoaWRlKGNvbnRhY3RzQ29kZSk7XG4gICAgc2hvdyhjb250YWN0c1Bob25lKTtcblxuICAgIHBob25lSW5wdXQuZm9jdXMoKTtcbiAgfVxuXG4gIHZhciBvbkNvZGVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjbGVhckVycm9yKCk7XG4gICAgaWYgKGNvZGVJbnB1dC52YWx1ZS5sZW5ndGggPT09IDcpIHtcbiAgICAgIGNvZGVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2RlQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIG9uQ29kZVN1Ym1pdCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAoY29kZUlucHV0LnZhbHVlICE9PSBDT1JSRUNUX0NPREUpIHtcbiAgICAgIGlmICghY29kZUxhYmVsLmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgY29kZUxhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWNvZGVJbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS13cm9uZy1pbnB1dCcpKSB7XG4gICAgICAgIGNvZGVJbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy0td3JvbmctaW5wdXQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGF0dGVtcHRzID09PSAwKSB7XG4gICAgICAgIGNvZGVFcnJvci50ZXh0Q29udGVudCA9IEVSUk9SX01FU1NBR0VTLmZpcnN0O1xuICAgICAgfVxuXG4gICAgICBpZiAoYXR0ZW1wdHMgPiAwKSB7XG4gICAgICAgIGNvZGVFcnJvci50ZXh0Q29udGVudCA9IEVSUk9SX01FU1NBR0VTLnNlY29uZDtcbiAgICAgICAgY29kZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgICAgfVxuXG4gICAgICBhdHRlbXB0cysrO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZXZpY2VSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXBlcnNvbmFsLWRhdGEnKTtcbiAgICAgIGRldmljZVJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tY29udGFjdHMnKTtcbiAgICB9XG4gIH07XG5cbiAgcGhvbmVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uUGhvbmVJbnB1dCk7XG4gIHByb2R1Y3RDaGFuZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblByb2R1Y3RDaGFuZ2VDbGljayk7XG4gIHBob25lRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvblBob25lU3VibWl0KTtcbiAgY29kZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25Db2RlSW5wdXQpO1xuICBjb2RlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbkNvZGVTdWJtaXQpO1xuICBwaG9uZUNoYW5nZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUGhvbmVDaGFuZ2VDbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gIHZhciBwaG9uZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9J3Bob25lLW51bWJlciddXCIpO1xuXG4gIHZhciBkZXZpY2VSZWdpc3RyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlLXJlZ2lzdHJhdGlvbicpO1xuICB2YXIgcmVnaXN0cmF0aW9uSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXZpY2UtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgZGV2aWNlRGF0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXZpY2UtZGF0YScpO1xuICB2YXIgZGV2aWNlRGF0YUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlLWRhdGEgZm9ybScpO1xuICB2YXIgd2FycmFudHlDb2RlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj0nc2VyaWFsLW51bWJlci0xJ10gYnV0dG9uXCIpO1xuICB2YXIgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHknKTtcbiAgdmFyIHBvcHVwQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHlfX2Nsb3NlJyk7XG4gIHZhciBwb3B1cE92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtd2FycmFudHlfX292ZXJsYXknKTtcblxuICB2YXIgY2FsZW5kYXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXZpY2UtZGF0YV9fcHVyY2hhc2UtZGF0ZScpO1xuICB2YXIgY2FsZW5kYXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlLWRhdGFfX2NhbGVuZGFyJyk7XG5cbiAgdmFyIHNlcmlhbE51bWJlcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRldmljZS1kYXRhX19zZXJpYWwtbnVtYmVyJyk7XG4gIHZhciBkYXRhU3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRldmljZS1kYXRhX19zdWJtaXQnKTtcblxuICBpZighd2FycmFudHlDb2RlQnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNoZWNrVmFsaWRpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYoXG4gICAgICBzZXJpYWxOdW1iZXJJbnB1dFswXS52YWx1ZS5sZW5ndGggPT09IDZcbiAgICAgICYmIHNlcmlhbE51bWJlcklucHV0WzFdLnZhbHVlLmxlbmd0aCA9PT0gNlxuICAgICAgJiYgc2VyaWFsTnVtYmVySW5wdXRbMl0udmFsdWUubGVuZ3RoID09PSA2XG4gICAgICAmJiAoL15bMC05Ll0rJC8pLnRlc3QoY2FsZW5kYXJJbnB1dC52YWx1ZSlcbiAgICApIHtcbiAgICAgIGRhdGFTdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhU3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBnZXRDb3JyZWN0TnVtYmVyID0gZnVuY3Rpb24gKG51bSkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKG51bSAvIDEwKSA+IDAgPyBudW0gOiAnMCcgKyBudW07XG4gIH07XG5cbiAgdmFyIGdldERhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZSk7XG5cbiAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcblxuICAgIHJldHVybiBnZXRDb3JyZWN0TnVtYmVyKGRheSkgKyAnLicgKyBnZXRDb3JyZWN0TnVtYmVyKG1vbnRoKSArICcuJyArIHllYXI7XG4gIH07XG5cbiAgdmFyIHBpY2tlciA9IG5ldyBQaWthZGF5KHtcbiAgICBmaWVsZDogY2FsZW5kYXJCdXR0b24sXG4gICAgZmlyc3REYXk6IDEsXG4gICAgb25TZWxlY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShwaWNrZXIpO1xuICAgICAgY2FsZW5kYXJJbnB1dC52YWx1ZSA9IGdldERhdGUoZGF0ZSk7XG4gICAgICBjaGVja1ZhbGlkaXR5KCk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKCc5OS45OS45OTk5JywgeyAncGxhY2Vob2xkZXInOiAn0JTQlC7QnNCcLtCT0JPQk9CTJ30pO1xuICBpbS5tYXNrKGNhbGVuZGFySW5wdXQpO1xuXG4gIHZhciBvblNlcmlhbE51bWJlcklucHV0ID0gZnVuY3Rpb24gKGV2dCkge1xuICAgIHZhciB0YXJnZXQgPSBldnQudGFyZ2V0O1xuXG4gICAgaWYgKHRhcmdldC52YWx1ZS5sZW5ndGggPT09IDYpIHtcbiAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSgnanMtLXdyb25nLWlucHV0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0YXJnZXQuaWQgPT09ICdzZXJpYWwtbnVtYmVyLTEnIHx8IHRhcmdldC5pZCA9PT0gJ3NlcmlhbC1udW1iZXItMicpIHtcbiAgICAgICAgdGFyZ2V0Lm5leHRTaWJsaW5nLm5leHRTaWJsaW5nLmZvY3VzKCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0YXJnZXQuaWQgPT09ICdzZXJpYWwtbnVtYmVyLTMnKSB7XG4gICAgICAgIGNhbGVuZGFySW5wdXQuZm9jdXMoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgIH1cblxuICAgIGNoZWNrVmFsaWRpdHkoKTtcbiAgfTtcblxuICB2YXIgb25DYWxlbmRhcklucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgIGNoZWNrVmFsaWRpdHkoKTtcbiAgICBjb25zb2xlLmxvZyhjYWxlbmRhcklucHV0LnZhbHVlLmxlbmd0aCk7XG5cbiAgfTtcblxuICB2YXIgb3BlblBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgncG9wdXAnKTtcbiAgfTtcblxuICB2YXIgY2xvc2VQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwJyk7XG4gIH1cblxuICB2YXIgb25XYXJyYW50eUNvZGVCdXR0b25DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICBvcGVuUG9wdXAoKTtcbiAgfTtcblxuICB2YXIgb25Qb3B1cENsb3NlQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2xvc2VQb3B1cCgpO1xuICB9O1xuXG4gIHZhciBvblBvcHVwT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGNsb3NlUG9wdXAoKTtcbiAgfTtcblxuICB2YXIgb25TdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgZGV2aWNlUmVnaXN0cmF0aW9uLmNsYXNzTGlzdC5hZGQoJ2pzLS1jb250YWN0cycpO1xuICAgIGRldmljZVJlZ2lzdHJhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZGV2aWNlLWRhdGEnKTtcblxuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMF0uY2xhc3NMaXN0LmFkZCgnanMtLWNoZWNrZWQnKTtcbiAgICByZWdpc3RyYXRpb25JdGVtWzFdLmNsYXNzTGlzdC5hZGQoJ2pzLS1hY3RpdmUnKTtcblxuICAgIHBob25lSW5wdXQuZm9jdXMoKTtcbiAgfTtcblxuICB3YXJyYW50eUNvZGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbldhcnJhbnR5Q29kZUJ1dHRvbkNsaWNrKTtcbiAgcG9wdXBDbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uUG9wdXBDbG9zZUNsaWNrKTtcbiAgcG9wdXBPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25Qb3B1cE92ZXJsYXlDbGljayk7XG5cbiAgc2VyaWFsTnVtYmVySW5wdXQuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uU2VyaWFsTnVtYmVySW5wdXQpO1xuICB9KTtcblxuICBjYWxlbmRhcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25DYWxlbmRhcklucHV0KTtcbiAgZGV2aWNlRGF0YUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgb25TdWJtaXQpO1xufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIHZhciBkZXZpY2VSZWdpc3RyYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGV2aWNlLXJlZ2lzdHJhdGlvbicpO1xuICB2YXIgcmVnaXN0cmF0aW9uSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZXZpY2UtcmVnaXN0cmF0aW9uX19uYXZpZ2F0aW9uLWl0ZW0nKTtcblxuICB2YXIgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZXJzb25hbC1kYXRhX19mb3JtJyk7XG4gIHZhciBzdXJuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nc3VybmFtZSddXCIpO1xuICB2YXIgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhIGlucHV0W25hbWU9J25hbWUnXVwiKTtcbiAgdmFyIHBhdHJvbnltaWNJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdwYXRyb255bWljJ11cIik7XG4gIHZhciBjaXR5SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbbmFtZT0nY2l0eSddXCIpO1xuICB2YXIgZW1haWxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVyc29uYWwtZGF0YSBpbnB1dFtuYW1lPSdlbWFpbCddXCIpO1xuICB2YXIgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBlcnNvbmFsLWRhdGEgaW5wdXRbdHlwZT0nY2hlY2tib3gnXVwiKTtcbiAgdmFyIGNoZWNrYm94TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyc29uYWwtZGF0YV9fYWdyZWVtZW50LXdyYXBwZXIgbGFiZWwnKTtcbiAgdmFyIGFncmVlbWVudCA9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wZXJzb25hbC1kYXRhX190ZXh0LXdyYXBwZXJcIik7XG4gIHZhciBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGVyc29uYWwtZGF0YV9fYnV0dG9uJyk7XG5cbiAgaWYgKCFzdXJuYW1lSW5wdXQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hlY2tWYWxpZGl0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoXG4gICAgICBzdXJuYW1lSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIG5hbWVJbnB1dC52YWxpZGl0eS52YWxpZFxuICAgICAgJiYgcGF0cm9ueW1pY0lucHV0LnZhbGlkaXR5LnZhbGlkXG4gICAgICAmJiBjaXR5SW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGVtYWlsSW5wdXQudmFsaWRpdHkudmFsaWRcbiAgICAgICYmIGNoZWNrYm94LmNoZWNrZWRcbiAgICApIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25JbnB1dCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICBjaGVja1ZhbGlkaXR5KCk7XG5cbiAgICB2YXIgaXRlbSA9IGV2dC50YXJnZXQ7XG4gICAgdmFyIGxhYmVsID0gaXRlbS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ3AnKTtcblxuICAgIGlmICghaXRlbS52YWxpZGl0eS52YWxpZCkge1xuICAgICAgaWYgKCFsYWJlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpdGVtLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICBpZiAobGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0tZXJyb3InKSkge1xuICAgICAgICBsYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBvbkNoZWNrYm94Q2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2hlY2tWYWxpZGl0eSgpO1xuXG4gICAgaWYgKCFjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICBpZiAoIWNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjaGVja2JveExhYmVsLmNsYXNzTGlzdC5hZGQoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWFncmVlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLS1lcnJvcicpKSB7XG4gICAgICAgIGFncmVlbWVudC5jbGFzc0xpc3QuYWRkKCdqcy0tZXJyb3InKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgaWYgKGNoZWNrYm94TGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy0td3JvbmctaW5wdXQnKSkge1xuICAgICAgICBjaGVja2JveExhYmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS13cm9uZy1pbnB1dCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWdyZWVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanMtLWVycm9yJykpIHtcbiAgICAgICAgYWdyZWVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLS1lcnJvcicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHZhciBvbkZvcm1TdWJtaXQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBkZXZpY2VSZWdpc3RyYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnanMtLXBlcnNvbmFsLWRhdGEnKTtcbiAgICBkZXZpY2VSZWdpc3RyYXRpb24uY2xhc3NMaXN0LmFkZCgnanMtLXJlZ2lzdHJhdGlvbi1lbmQnKTtcblxuICAgIHJlZ2lzdHJhdGlvbkl0ZW1bMV0uY2xhc3NMaXN0LmFkZCgnanMtLWNoZWNrZWQnKTtcbiAgICByZWdpc3RyYXRpb25JdGVtWzJdLmNsYXNzTGlzdC5hZGQoJ2pzLS1hY3RpdmUnKTtcbiAgfTtcblxuICBzdXJuYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgbmFtZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25JbnB1dCk7XG4gIHBhdHJvbnltaWNJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBjaXR5SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbiAgZW1haWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uSW5wdXQpO1xuICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2xpY2spO1xuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgb25Gb3JtU3VibWl0KTtcbn0pKCk7XG4iXX0=
